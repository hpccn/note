<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><title>浅显易懂的Git教程</title></head><body>

<h2><span style="font-family: 宋体;">浅显易懂的</span><span lang="EN-US">Git</span><span style="font-family: 宋体;">教程！</span><span lang="EN-US"><o:p></o:p></span></h2>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">为什么要编写这个教程？因为我在学习<span lang="EN-US">Git</span>的过程中，买过书，也在网上<span lang="EN-US">Google</span>了一堆<span lang="EN-US">Git</span>相关的文章和教程，但令人失望的是，这些教程不是难得令人发指，就是简单得一笔带过，或者，只支离破碎地介绍<span lang="EN-US">Git</span>的某几个命令，还有直接从<span lang="EN-US">Git</span>手册粘贴帮助文档的，总之，初学者很难找到一个由浅入深，学完后能立刻上手的<span lang="EN-US">Git</span>教程。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">既然号称史上最浅显易懂的<span lang="EN-US">Git</span>教程，那这个教程有什么让你怦然心动的特点呢？<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">首先，本教程绝对面向初学者，没有接触过版本控制概念的读者也可以轻松入门，不必担心起步难度；<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">其次，本教程实用性超强，边学边练，一点也不觉得枯燥。而且，你所学的<span lang="EN-US">Git</span>命令是<span lang="EN-US">&ldquo;</span>充分且必要<span lang="EN-US">&rdquo;</span>的，掌握了这些东西，你就可以通过<span lang="EN-US">Git</span>轻松地完成你的工作。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><a name="#-E6-96-87-E5-AD-97-2B-E5-9B-BE-E7-89-87"></a><b><span style="font-size: 13.5pt; font-family: 宋体;">文字<span lang="EN-US">+</span>图片还看不明白？<span lang="EN-US"><o:p></o:p></span></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">本教程只会让你成为<span lang="EN-US">Git</span>用户，不会让你成为<span lang="EN-US">Git</span>专家。很多<span lang="EN-US">Git</span>命令只有那些专家才明白（事实上我也不明白，因为我不是<span lang="EN-US">Git</span>专家），但我保证这些命令可能你一辈子都不会用到。既然<span lang="EN-US">Git</span>是一个工具，就没必要把时间浪费在那些<span lang="EN-US">&ldquo;</span>高级<span lang="EN-US">&rdquo;</span>但几乎永远不会用到的命令上。一旦你真的非用不可了，到时候再自行<span lang="EN-US">Google</span>或者请教专家也未迟。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你是一个开发人员，想用上这个世界上目前最先进的分布式版本控制系统，那么，赶快开始学习吧！<span lang="EN-US"><o:p></o:p></span></span></p>

<h2><span lang="EN-US">Git</span><span style="font-family: 宋体;">简介</span><span lang="EN-US"><o:p></o:p></span></h2>

<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Git</span><span style="font-size: 12pt; font-family: 宋体;">是什么？<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Git</span><span style="font-size: 12pt; font-family: 宋体;">是目前世界上最先进的分布式版本控制系统（没有之一）。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Git</span><span style="font-size: 12pt; font-family: 宋体;">有什么特点？简单来说就是：高端大气上档次！<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">那什么是版本控制系统？<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你用<span lang="EN-US">Microsoft Word</span>写过长篇大论，那你一定有这样的经历：<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">想删除一个段落，又怕将来想恢复找不回来怎么办？有办法，先把当前文件<span lang="EN-US">&ldquo;</span>另存为<span lang="EN-US">&hellip;&hellip;&rdquo;</span>一个新的<span lang="EN-US">Word</span>文件，再接着改，改到一定程度，再<span lang="EN-US">&ldquo;</span>另存为<span lang="EN-US">&hellip;&hellip;&rdquo;</span>一个新文件，这样一直改下去，最后你的<span lang="EN-US">Word</span>文档变成了这样：<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="图片_x0020_1" o:spid="_x0000_i1058" type="#_x0000_t75"
 alt="lots-of-docs" style='width:294pt;height:199.5pt;visibility:visible;
 mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image001.jpg"
  o:title="lots-of-docs"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image001.jpg" alt="lots-of-docs" v:shapes="图片_x0020_1" height="266" width="392"><!--[endif]--></span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">过了一周，你想找回被删除的文字，但是已经记不清删除前保存在哪个文件里了，只好一个一个文件去找，真麻烦。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">看着一堆乱七八糟的文件，想保留最新的一个，然后把其他的删掉，又怕哪天会用上，还不敢删，真郁闷。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">更要命的是，有些部分需要你的财务同事帮助填写，于是你把文件<span lang="EN-US">Copy</span>到<span lang="EN-US">U</span>盘里给她（也可能通过<span lang="EN-US">Email</span>发送一份给她），然后，你继续修改<span lang="EN-US">Word</span>文件。一天后，同事再把<span lang="EN-US">Word</span>文件传给你，此时，你必须想想，发给她之后到你收到她的文件期间，你作了哪些改动，得把你的改动和她的部分合并，真困难。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">于是你想，如果有一个软件，不但能自动帮我记录每次文件的改动，还可以让同事协作编辑，这样就不用自己管理一堆类似的文件了，也不需要把文件传来传去。如果想查看某次改动，只需要在软件里瞄一眼就可以，岂不是很方便？<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">这个软件用起来就应该像这个样子，能记录每次文件的改动：<span lang="EN-US"><o:p></o:p></span></span></p>

<table class="MsoNormalTable" style="" border="0" cellpadding="0">
 <tbody><tr style="">
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-size: 12pt; font-family: 宋体;">版本<span lang="EN-US"><o:p></o:p></span></span></b></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-size: 12pt; font-family: 宋体;">用户<span lang="EN-US"><o:p></o:p></span></span></b></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-size: 12pt; font-family: 宋体;">说明<span lang="EN-US"><o:p></o:p></span></span></b></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-size: 12pt; font-family: 宋体;">日期<span lang="EN-US"><o:p></o:p></span></span></b></p>
  </td>
 </tr>
 <tr style="">
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">1<o:p></o:p></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">张三<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">删除了软件服务条款<span lang="EN-US">5<o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">7/12 10:38<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">2<o:p></o:p></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">张三<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">增加了<span lang="EN-US">License</span>人数限制<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">7/12 18:09<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">3<o:p></o:p></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">李四<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">财务部门调整了合同金额<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">7/13 9:51<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">4<o:p></o:p></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">张三<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">延长了免费升级周期<span lang="EN-US"><o:p></o:p></span></span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">7/14 15:17<o:p></o:p></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">这样，你就结束了手动管理多个<span lang="EN-US">&ldquo;</span>版本<span lang="EN-US">&rdquo;</span>的史前时代，进入到版本控制的<span lang="EN-US">20</span>世纪。<span lang="EN-US"><o:p></o:p></span></span></p>

<h4><span lang="EN-US">Git</span><span style="font-family: 宋体;">的诞生</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>很多人都知道，<span lang="EN-US">Linus</span>在<span lang="EN-US">1991</span>年创建了开源的<span lang="EN-US">Linux</span>，从此，<span lang="EN-US">Linux</span>系统不断发展，已经成为最大的服务器系统软件了。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Linus</span>虽然创建了<span lang="EN-US">Linux</span>，但<span lang="EN-US">Linux</span>的壮大是靠全世界热心的志愿者参与的，这么多人在世界各地为<span lang="EN-US">Linux</span>编写代码，那<span lang="EN-US">Linux</span>的代码是如何管理的呢？<span lang="EN-US"><o:p></o:p></span></p>

<p>事实是，在<span lang="EN-US">2002</span>年以前，世界各地的志愿者把源代码文件通过<span lang="EN-US">diff</span>的方式发给<span lang="EN-US">Linus</span>，然后由<span lang="EN-US">Linus</span>本人通过手工方式合并代码！<span lang="EN-US"><o:p></o:p></span></p>

<p>你也许会想，为什么<span lang="EN-US">Linus</span>不把<span lang="EN-US">Linux</span>代码放到版本控制系统里呢？不是有<span lang="EN-US">CVS</span>、<span lang="EN-US">SVN</span>这些免费的版本控制系统吗？因为<span lang="EN-US">Linus</span>坚定地反对<span lang="EN-US">CVS</span>和<span lang="EN-US">SVN</span>，这些集中式的版本控制系统不但速度慢，而且必须联网才能使用。有一些商用的版本控制系统，虽然比<span lang="EN-US">CVS</span>、<span lang="EN-US">SVN</span>好用，但那是付费的，和<span lang="EN-US">Linux</span>的开源精神不符。<span lang="EN-US"><o:p></o:p></span></p>

<p>不过，到了<span lang="EN-US">2002</span>年，<span lang="EN-US">Linux</span>系统已经发展了十年了，代码库之大让<span lang="EN-US">Linus</span>很难继续通过手工方式管理了，社区的弟兄们也对这种方式表达了强烈不满，于是<span lang="EN-US">Linus</span>选择了一个商业的版本控制系统<span lang="EN-US">BitKeeper</span>，<span lang="EN-US">BitKeeper</span>的东家<span lang="EN-US">BitMover</span>公司出于人道主义精神，授权<span lang="EN-US">Linux</span>社区免费使用这个版本控制系统。<span lang="EN-US"><o:p></o:p></span></p>

<p>安定团结的大好局面在<span lang="EN-US">2005</span>年就被打破了，原因是<span lang="EN-US">Linux</span>社区牛人聚集，不免沾染了一些梁山好汉的江湖习气。开发<span lang="EN-US">Samba</span>的<span lang="EN-US">Andrew</span>试图破解<span lang="EN-US">BitKeeper</span>的协议（这么干的其实也不只他一个），被<span lang="EN-US">BitMover</span>公司发现了（监控工作做得不错！），于是<span lang="EN-US">BitMover</span>公司怒了，要收回<span lang="EN-US">Linux</span>社区的免费使用权。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Linus</span>可以向<span lang="EN-US">BitMover</span>公司道个歉，保证以后严格管教弟兄们，嗯，这是不可能的。实际情况是这样的：<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Linus</span>花了两周时间自己用<span lang="EN-US">C</span>写了一个分布式版本控制系统，这就是<span lang="EN-US">Git</span>！一个月之内，<span lang="EN-US">Linux</span>系统的源码已经由<span lang="EN-US">Git</span>管理了！牛是怎么定义的呢？大家可以体会一下。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>迅速成为最流行的分布式版本控制系统，尤其是<span lang="EN-US">2008</span>年，<span lang="EN-US">GitHub</span>网站上线了，它为开源项目免费提供<span lang="EN-US">Git</span>存储，无数开源项目开始迁移至<span lang="EN-US">GitHub</span>，包括<span lang="EN-US">jQuery</span>，<span lang="EN-US">PHP</span>，<span lang="EN-US">Ruby</span>等等。<span lang="EN-US"><o:p></o:p></span></p>

<p>历史就是这么偶然，如果不是当年<span lang="EN-US">BitMover</span>公司威胁<span lang="EN-US">Linux</span>社区，可能现在我们就没有免费而超级好用的<span lang="EN-US">Git</span>了。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">集中式</span><span lang="EN-US">vs</span><span style="font-family: 宋体;">分布式</span><span lang="EN-US"><o:p></o:p></span></h4>

<p><span lang="EN-US">Linus</span>一直痛恨的<span lang="EN-US">CVS</span>及<span lang="EN-US">SVN</span>都是集中式的版本控制系统，而<span lang="EN-US">Git</span>是分布式版本控制系统，集中式和分布式版本控制系统有什么区别呢？<span lang="EN-US"><o:p></o:p></span></p>

<p>先说集中式版本控制系统，版本库是集中存放在中央服务器的，而干活的时候，用的都是自己的电脑，所以要先从中央服务器取得最新的版本，然后开始干
活，干完活了，再把自己的活推送给中央服务器。中央服务器就好比是一个图书馆，你要改一本书，必须先从图书馆借出来，然后回到家自己改，改完了，再放回图
书馆。<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_3"
 o:spid="_x0000_i1057" type="#_x0000_t75" alt="central-repo" style='width:308.25pt;
 height:222.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image002.jpg"
  o:title="central-repo"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image002.jpg" alt="central-repo" v:shapes="图片_x0020_3" height="297" width="411"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>集中式版本控制系统最大的毛病就是必须联网才能工作，如果在局域网内还好，带宽够大，速度够快，可如果在互联网上，遇到网速慢的话，可能提交一个<span lang="EN-US">10M</span>的文件就需要<span lang="EN-US">5</span>分钟，这还不得把人给憋死啊。<span lang="EN-US"><o:p></o:p></span></p>

<p>那分布式版本控制系统与集中式版本控制系统有何不同呢？首先，分布式版本控制系统根本没有<span lang="EN-US">&ldquo;</span>中央服务器<span lang="EN-US">&rdquo;</span>，每个人的电脑上都是一个完整的版本库，这样，你工作的时候，就不需要联网了，因为版本库就在你自己的电脑上。既然每个人电脑上都有一个完整的版本库，那多个人如何协作呢？比方说你在自己电脑上改了文件<span lang="EN-US">A</span>，你的同事也在他的电脑上改了文件<span lang="EN-US">A</span>，这时，你们俩之间只需把各自的修改推送给对方，就可以互相看到对方的修改了。<span lang="EN-US"><o:p></o:p></span></p>

<p>和集中式版本控制系统相比，分布式版本控制系统的安全性要高很多，因为每个人电脑里都有完整的版本库，某一个人的电脑坏掉了不要紧，随便从其他人那里复制一个就可以了。而集中式版本控制系统的中央服务器要是出了问题，所有人都没法干活了。<span lang="EN-US"><o:p></o:p></span></p>

<p>在实际使用分布式版本控制系统的时候，其实很少在两人之间的电脑上推送版本库的修改，因为可能你们俩不在一个局域网内，两台电脑互相访问不了，也可能今天你的同事病了，他的电脑压根没有开机。因此，分布式版本控制系统通常也有一台充当<span lang="EN-US">&ldquo;</span>中央服务器<span lang="EN-US">&rdquo;</span>的电脑，但这个服务器的作用仅仅是用来方便<span lang="EN-US">&ldquo;</span>交换<span lang="EN-US">&rdquo;</span>大家的修改，没有它大家也一样干活，只是交换修改不方便而已。<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_2"
 o:spid="_x0000_i1056" type="#_x0000_t75" alt="distributed-repo" style='width:378pt;
 height:324.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image003.jpg"
  o:title="distributed-repo"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image003.jpg" alt="distributed-repo" v:shapes="图片_x0020_2" height="433" width="504"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>当然，<span lang="EN-US">Git</span>的优势不单是不必联网这么简单，后面我们还会看到<span lang="EN-US">Git</span>极其强大的分支管理，把<span lang="EN-US">SVN</span>等远远抛在了后面。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">CVS</span>作为最早的开源而且免费的集中式版本控制系统，直到现在还有不少人在用。由于<span lang="EN-US">CVS</span>自身设计的问题，会造成提交文件不完整，版本库莫名其妙损坏的情况。同样是开源而且免费的<span lang="EN-US">SVN</span>修正了<span lang="EN-US">CVS</span>的一些稳定性问题，是目前用得最多的集中式版本库控制系统。<span lang="EN-US"><o:p></o:p></span></p>

<p>除了免费的外，还有收费的集中式版本控制系统，比如<span lang="EN-US">IBM</span>的<span lang="EN-US">ClearCase</span>（以前是<span lang="EN-US">Rational</span>公司的，被<span lang="EN-US">IBM</span>收购了），特点是安装比<span lang="EN-US">Windows</span>还大，运行比蜗牛还慢，能用<span lang="EN-US">ClearCase</span>的一般是世界<span lang="EN-US">500</span>强，他们有个共同的特点是财大气粗，或者人傻钱多。<span lang="EN-US"><o:p></o:p></span></p>

<p>微软自己也有一个集中式版本控制系统叫<span lang="EN-US">VSS</span>，集成在<span lang="EN-US">Visual
Studio</span>中。由于其反人类的设计，连微软自己都不好意思用了。<span lang="EN-US"><o:p></o:p></span></p>

<p>分布式版本控制系统除了<span lang="EN-US">Git</span>以及促使<span lang="EN-US">Git</span>诞生的<span lang="EN-US">BitKeeper</span>外，还有类似<span lang="EN-US">Git</span>的<span lang="EN-US">Mercurial</span>和<span lang="EN-US">Bazaar</span>等。这些分布式版本控制系统各有特点，但最快、最简单也最流行的依然是<span lang="EN-US">Git</span>！<span lang="EN-US"><o:p></o:p></span></p>

<h2><a name="_安装Git"></a><span style="font-family: 宋体;">安装</span><span lang="EN-US">Git<o:p></o:p></span></h2>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">最早<span lang="EN-US">Git</span>是在<span lang="EN-US">Linux</span>上开发的，很长一段时间内，<span lang="EN-US">Git</span>也只能在<span lang="EN-US">Linux</span>和<span lang="EN-US">Unix</span>系统上跑。不过，慢慢地有人把它移植到了<span lang="EN-US">Windows</span>上。现在，<span lang="EN-US">Git</span>可以在<span lang="EN-US">Linux</span>、<span lang="EN-US">Unix</span>、<span lang="EN-US">Mac</span>和<span lang="EN-US">Windows</span>这几大平台上正常运行了。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">要使用<span lang="EN-US">Git</span>，第一步当然是安装<span lang="EN-US">Git</span>了。根据你当前使用的平台来阅读下面的文字：<span lang="EN-US"><o:p></o:p></span></span></p>

<h3><a name="#-E5-9C-A8Linux-E4-B8-8A-E5-AE-89-E8-A3-"></a>在<span lang="EN-US">Linux</span>上安装<span lang="EN-US">Git<o:p></o:p></span></h3>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">首先，你可以试着输入<span lang="EN-US">git</span>，看看系统有没有安装<span lang="EN-US">Git</span>：<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">$ git<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">The program 'git' is currently not installed. You can
install it by typing:<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">sudo apt-get install git<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">像上面的命令，有很多<span lang="EN-US">Linux</span>会友好地告诉你<span lang="EN-US">Git</span>没有安装，还会告诉你如何安装<span lang="EN-US">Git</span>。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你碰巧用<span lang="EN-US">Debian</span>或<span lang="EN-US">Ubuntu Linux</span>，通过一条<span lang="EN-US">sudo apt-get install git</span>就可以直接完成<span lang="EN-US">Git</span>的安装，非常简单。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">老一点的<span lang="EN-US">Debian</span>或<span lang="EN-US">Ubuntu Linux</span>，要把命令改为<span lang="EN-US">sudo apt-get install git-core</span>，因为以前有个软件也叫<span lang="EN-US">GIT</span>（<span lang="EN-US">GNU Interactive Tools</span>），结果<span lang="EN-US">Git</span>就只能叫<span lang="EN-US">git-core</span>了。由于<span lang="EN-US">Git</span>名气实在太大，后来就把<span lang="EN-US">GNU Interactive Tools</span>改成<span lang="EN-US">gnuit</span>，<span lang="EN-US">git-core</span>正式改为<span lang="EN-US">git</span>。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果是其他<span lang="EN-US">Linux</span>版本，可以直接通过源码安装。先从<span lang="EN-US">Git</span>官网下载源码，然后解压，依次输入：<span lang="EN-US">./config</span>，<span lang="EN-US">make</span>，<span lang="EN-US">sudo
make install</span>这几个命令安装就好了。<span lang="EN-US"><o:p></o:p></span></span></p>

<h3><a name="#-E5-9C-A8Mac-OS-X-E4-B8-8A-E5-AE-89-E8-"></a>在<span lang="EN-US">Mac
OS X</span>上安装<span lang="EN-US">Git<o:p></o:p></span></h3>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你正在使用<span lang="EN-US">Mac</span>做开发，有两种安装<span lang="EN-US">Git</span>的方法。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">一是安装<span lang="EN-US">homebrew</span>，然后通过<span lang="EN-US">homebrew</span>安装<span lang="EN-US">Git</span>，具体方法请参考<span lang="EN-US">homebrew</span>的文档：</span><span lang="EN-US"><a href="http://brew.sh/" target="_blank"><span style="font-size: 12pt; font-family: 宋体;">http://brew.sh/</span></a></span><span style="font-size: 12pt; font-family: 宋体;">。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">第二种方法更简单，也是推荐的方法，就是直接从<span lang="EN-US">AppStore</span>安装<span lang="EN-US">Xcode</span>，<span lang="EN-US">Xcode</span>集成了<span lang="EN-US">Git</span>，不过默认没有安装，你需要运行<span lang="EN-US">Xcode</span>，选择菜单<span lang="EN-US">&ldquo;Xcode&rdquo;-&gt;&ldquo;Preferences&rdquo;</span>，在弹出窗口中找到<span lang="EN-US">&ldquo;Downloads&rdquo;</span>，选择<span lang="EN-US">&ldquo;Command Line Tools&rdquo;</span>，点<span lang="EN-US">&ldquo;Install&rdquo;</span>就可以完成安装了。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_5" o:spid="_x0000_i1055"
 type="#_x0000_t75" alt="install-git-by-xcode" style='width:338.25pt;height:247.5pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image004.jpg"
  o:title="install-git-by-xcode"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image004.jpg" alt="install-git-by-xcode" v:shapes="图片_x0020_5" border="0" height="330" width="451"><!--[endif]--></span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Xcode</span><span style="font-size: 12pt; font-family: 宋体;">是<span lang="EN-US">Apple</span>官方<span lang="EN-US">IDE</span>，功能非常强大，是开发<span lang="EN-US">Mac</span>和<span lang="EN-US">iOS App</span>的必选装备，而且是免费的！<span lang="EN-US"><o:p></o:p></span></span></p>

<h3><a name="#-E5-9C-A8Windows-E4-B8-8A-E5-AE-89-E8-A"></a>在<span lang="EN-US">Windows</span>上安装<span lang="EN-US">Git<o:p></o:p></span></h3>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">实话实说，<span lang="EN-US">Windows</span>是最烂的开发平台，如果不是开发<span lang="EN-US">Windows</span>游戏或者在<span lang="EN-US">IE</span>里调试页面，一般不推荐用<span lang="EN-US">Windows</span>。不过，既然已经上了微软的贼船，也是有办法安装<span lang="EN-US">Git</span>的。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Windows</span><span style="font-size: 12pt; font-family: 宋体;">下要使用很多<span lang="EN-US">Linux/Unix</span>的工具时，需要<span lang="EN-US">Cygwin</span>这样的模拟环境，<span lang="EN-US">Git</span>也一样。<span lang="EN-US">Cygwin</span>的安装和配置都比较复杂，就不建议你折腾了。不过，有高人已经把模拟环境和<span lang="EN-US">Git</span>都打包好了，名叫<span lang="EN-US">msysgit</span>，只需要下载一个单独的<span lang="EN-US">exe</span>安装程序，其他什么也不用装，绝对好用。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">msysgit</span><span style="font-size: 12pt; font-family: 宋体;">是<span lang="EN-US">Windows</span>版的<span lang="EN-US">Git</span>，从</span><span lang="EN-US"><a href="https://git-for-windows.github.io" target="_blank"><span style="font-size: 12pt; font-family: 宋体;">https://git-for-windows.github.io</span></a></span><span style="font-size: 12pt; font-family: 宋体;">下载（网速慢的同学请移步</span><span lang="EN-US"><a href="https://pan.baidu.com/s/1kU5OCOB#list/path=%2Fpub%2Fgit" target="_blank"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><span lang="EN-US">国内镜像</span></span></a></span><span style="font-size: 12pt; font-family: 宋体;">），然后按默认选项安装即可。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">安装完成后，在开始菜单里找到<span lang="EN-US">&ldquo;Git&rdquo;-&gt;&ldquo;Git Bash&rdquo;</span>，蹦出一个类似命令行窗口的东西，就说明<span lang="EN-US">Git</span>安装成功！<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_4" o:spid="_x0000_i1054"
 type="#_x0000_t75" alt="install-git-on-windows" style='width:335.25pt;
 height:194.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image005.jpg"
  o:title="install-git-on-windows"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image005.jpg" alt="install-git-on-windows" v:shapes="图片_x0020_4" border="0" height="259" width="447"><!--[endif]--></span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">安装完成后，还需要最后一步设置，在命令行输入：<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">$ git config --global user.name "Your Name"<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">$ git config --global user.email
"email@example.com"<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">因为<span lang="EN-US">Git</span>是分布式版本控制系统，所以，每个机器都必须自报家门：你的名字和<span lang="EN-US">Email</span>地址。你也许会担心，如果有人故意冒充别人怎么办？这个不必担心，首先我们相信大家都是善良无知的群众，其次，真的有冒充的也是有办法可查的。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">注意<span lang="EN-US">git config</span>命令的<span lang="EN-US">--global</span>参数，用了这个参数，表示你这台机器上所有的<span lang="EN-US">Git</span>仓库都会使用这个配置，当然也可以对某个仓库指定不同的用户名和<span lang="EN-US">Email</span>地址。<span lang="EN-US"><o:p></o:p></span></span></p>

<h2><span style="font-family: 宋体;">创建版本库</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>什么是版本库呢？版本库又名仓库，英文名<strong><span style="font-family: 宋体;" lang="EN-US">repository</span></strong>，你可以简单理解成一个目录，这个目录里面的所有文件都可以被<span lang="EN-US">Git</span>管理起来，每个文件的修改、删除，<span lang="EN-US">Git</span>都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以<span lang="EN-US">&ldquo;</span>还原<span lang="EN-US">&rdquo;</span>。<span lang="EN-US"><o:p></o:p></span></p>

<p>所以，创建一个版本库非常简单，首先，选择一个合适的地方，创建一个空目录：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">mkdir learngit<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">cd learngit<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">pwd<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">/</span></code><span class="constant"><span lang="EN-US">Users</span></span><code><span lang="EN-US">/michael/learngit<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">pwd</span></code>命令用于显示当前目录。在我的<span lang="EN-US">Mac</span>上，这个仓库位于<code><span lang="EN-US">/Users/michael/learngit</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="color: red;">如果你使用<span lang="EN-US">Windows</span>系统，为了避免遇到各种莫名其妙的问题，请确保目录名（包括父目录）不包含中文。</span><span lang="EN-US"><o:p></o:p></span></p>

<p>第二步，通过<code><span lang="EN-US">git init</span></code>命令把这个目录变成<span lang="EN-US">Git</span>可以管理的仓库：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git init<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Initialized</span></span><code><span lang="EN-US"> empty </span></code><span class="constant"><span lang="EN-US">Git</span></span><code><span lang="EN-US"> repository </span></code><span class="keyword"><span lang="EN-US">in</span></span><code><span lang="EN-US"> /</span></code><span class="constant"><span lang="EN-US">Users</span></span><code><span lang="EN-US">/michael/learngit/.git/<o:p></o:p></span></code></pre>

<p>瞬间<span lang="EN-US">Git</span>就把仓库建好了，而且告诉你是一个空的仓库（<span lang="EN-US">empty Git
repository</span>），细心的读者可以发现当前目录下多了一个<code><span lang="EN-US">.git</span></code>的目录，这个目录是<span lang="EN-US">Git</span>来跟踪管理版本库的，没事千万不要手动修改这个目录里面的文件，不然改乱了，就把<span lang="EN-US">Git</span>仓库给破坏了。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你没有看到<code><span lang="EN-US">.git</span></code>目录，那是因为这个目录默认是隐藏的，用<code><span lang="EN-US">ls -ah</span></code>命令就可以看见。<span lang="EN-US"><o:p></o:p></span></p>

<p>也不一定必须在空目录下创建<span lang="EN-US">Git</span>仓库，选择一个已经有东西的目录也是可以的。不过，不建议你使用自己正在开发的公司项目来学习<span lang="EN-US">Git</span>，否则造成的一切后果概不负责。<span lang="EN-US"><o:p></o:p></span></p>

<h3><a name="#-E6-8A-8A-E6-96-87-E4-BB-B6-E6-B7-BB-E5"></a>把文件添加到版本库<span lang="EN-US"><o:p></o:p></span></h3>

<p>首先这里再明确一下，所有的版本控制系统，其实只能跟踪文本文件的改动，比如<span lang="EN-US">TXT</span>文件，网页，所有的程序代码等等，<span lang="EN-US">Git</span>也不例外。版本控制系统可以告诉你每次的改动，比如在第<span lang="EN-US">5</span>行加了一个单词<span lang="EN-US">&ldquo;Linux&rdquo;</span>，在第<span lang="EN-US">8</span>行删了一个单词<span lang="EN-US">&ldquo;Windows&rdquo;</span>。而图片、视频这些二进制文件，虽然也能由版本控制系统管理，但没法跟踪文件的变化，只能把二进制文件每次改动串起来，也就是只知道图片从<span lang="EN-US">100KB</span>改成了<span lang="EN-US">120KB</span>，但到底改了啥，版本控制系统不知道，也没法知道。<span lang="EN-US"><o:p></o:p></span></p>

<p>不幸的是，<span lang="EN-US">Microsoft</span>的<span lang="EN-US">Word</span>格式是二进制格式，因此，版本控制系统是没法跟踪<span lang="EN-US">Word</span>文件的改动的，前面我们举的例子只是为了演示，如果要真正使用版本控制系统，就要以纯文本方式编写文件。<span lang="EN-US"><o:p></o:p></span></p>

<p>因为文本是有编码的，比如中文有常用的<span lang="EN-US">GBK</span>编码，日文有<span lang="EN-US">Shift_JIS</span>编码，如果没有历史遗留问题，强烈建议使用标准的<span lang="EN-US">UTF-8</span>编码，所有语言使用同一种编码，既没有冲突，又被所有平台所支持。<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="color: red;">使用<span lang="EN-US">Windows</span>的童鞋要特别注意：</span><span lang="EN-US"><o:p></o:p></span></p>

<p>千万不要使用<span lang="EN-US">Windows</span>自带的<strong><span style="font-family: 宋体;">记事本</span></strong>编辑任何文本文件。原因是<span lang="EN-US">Microsoft</span>开发记事本的团队使用了一个非常弱智的行为来保存<span lang="EN-US">UTF-8</span>编码的文件，他们自作聪明地在每个文件开头添加了<span lang="EN-US">0xefbbbf</span>（十六进制）的字符，你会遇到很多不可思议的问题，比如，网页第一行可能会显示一个<span lang="EN-US">&ldquo;?&rdquo;</span>，明明正确的程序一编译就报语法错误，等等，都是由记事本的弱智行为带来的。建议你下载<span lang="EN-US"><a href="http://notepad-plus-plus.org/" target="_blank">Notepad++</a></span>代替记事本，不但功能强大，而且免费！记得把<span lang="EN-US">Notepad++</span>的默认编码设置为<span lang="EN-US">UTF-8 without BOM</span>即可：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_6"
 o:spid="_x0000_i1053" type="#_x0000_t75" alt="set-utf8-notepad++" style='width:357pt;
 height:207pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image006.jpg"
  o:title="set-utf8-notepad++"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image006.jpg" alt="set-utf8-notepad++" v:shapes="图片_x0020_6" border="0" height="276" width="476"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>言归正传，现在我们编写一个<code><span lang="EN-US">readme.txt</span></code>文件，内容如下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p>一定要放到<code><span lang="EN-US">learngit</span></code>目录下（子目录也行），因为这是一个<span lang="EN-US">Git</span>仓库，放到其他地方<span lang="EN-US">Git</span>再厉害也找不到这个文件。<span lang="EN-US"><o:p></o:p></span></p>

<p>和把大象放到冰箱需要<span lang="EN-US">3</span>步相比，把一个文件放到<span lang="EN-US">Git</span>仓库只需要两步。<span lang="EN-US"><o:p></o:p></span></p>

<p>第一步，用命令<code><span lang="EN-US">git add</span></code>告诉<span lang="EN-US">Git</span>，把文件添加到仓库：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt<o:p></o:p></span></code></pre>

<p>执行上面的命令，没有任何显示，这就对了，<span lang="EN-US">Unix</span>的哲学是<span lang="EN-US">&ldquo;</span>没有消息就是好消息<span lang="EN-US">&rdquo;</span>，说明添加成功。<span lang="EN-US"><o:p></o:p></span></p>

<p>第二步，用命令<code><span lang="EN-US">git commit</span></code>告诉<span lang="EN-US">Git</span>，把文件提交到仓库：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"wrote a readme file"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master (root-</span></span><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US">) cb926e7] wrote a readme file<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">2</span></span><span class="operator"><span lang="EN-US"> insertions(+)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">create</span></span><span class="operator"><span lang="EN-US"> mode </span></span><span class="number"><span lang="EN-US">100644</span></span><span class="operator"><span lang="EN-US"> readme.txt<o:p></o:p></span></span></pre>

<p>简单解释一下<code><span lang="EN-US">git commit</span></code>命令，<code><span lang="EN-US">-m</span></code>后面输入的是本次提交的说明，可以输入任意内容，当然最好是有意义的，这样你就能从历史记录里方便地找到改动记录。<span lang="EN-US"><o:p></o:p></span></p>

<p>嫌麻烦不想输入<code><span lang="EN-US">-m "xxx"</span></code>行不行？确实有办法可以这么干，但是强烈不建议你这么干，因为输入说明对自己对别人阅读都很重要。实在不想输入说明的童鞋请自行<span lang="EN-US">Google</span>，我不告诉你这个参数。<span lang="EN-US"><o:p></o:p></span></p>

<p><code><span lang="EN-US">git commit</span></code>命令执行成功后会告诉你，<span lang="EN-US">1</span>个文件被改动（我们新添加的<span lang="EN-US">readme.txt</span>文件），插入了两行内容（<span lang="EN-US">readme.txt</span>有两行内容）。<span lang="EN-US"><o:p></o:p></span></p>

<p>为什么<span lang="EN-US">Git</span>添加文件需要<code><span lang="EN-US">add</span></code>，<code><span lang="EN-US">commit</span></code>一共两步呢？因为<code><span lang="EN-US">commit</span></code>可以一次提交很多文件，所以你可以多次<code><span lang="EN-US">add</span></code>不同的文件，比如：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add file1.txt<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add file2.txt file3.txt<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"add 3 files."</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<h3><a name="#-E5-B0-8F-E7-BB-93"></a>小结<span lang="EN-US"><o:p></o:p></span></h3>

<p>现在总结一下今天学的两点内容：<span lang="EN-US"><o:p></o:p></span></p>

<p>初始化一个<span lang="EN-US">Git</span>仓库，使用<code><span lang="EN-US">git init</span></code>命令。<span lang="EN-US"><o:p></o:p></span></p>

<p>添加文件到<span lang="EN-US">Git</span>仓库，分两步：<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->第一步，使用命令<code><span lang="EN-US">git add
&lt;file&gt;</span></code>，注意，可反复多次使用，添加多个文件；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->第二步，使用命令<code><span lang="EN-US">git commit</span></code>，完成。<span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">时光机穿梭</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>我们已经成功地添加并提交了一个<span lang="EN-US">readme.txt</span>文件，现在，是时候继续工作了，于是，我们继续修改<span lang="EN-US">readme.txt</span>文件，改成如下内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p>现在，运行<code><span lang="EN-US">git status</span></code>命令看看结果：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git status</span></code>命令可以让我们时刻掌握仓库当前的状态，上面的命令告诉我们，<span lang="EN-US">readme.txt</span>被修改过了，但还没有准备提交的修改。<span lang="EN-US"><o:p></o:p></span></p>

<p>虽然<span lang="EN-US">Git</span>告诉我们<span lang="EN-US">readme.txt</span>被修改了，但如果能看看具体修改了什么内容，自然是很好的。比如你休假两周从国外回来，第一天上班时，已经记不清上次怎么修改的<span lang="EN-US">readme.txt</span>，所以，需要用<code><span lang="EN-US">git diff</span></code>这个命令看看：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git diff readme.txt <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">diff --git a/readme.txt b/readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">index </span></code><span class="number"><span lang="EN-US">46</span></span><code><span lang="EN-US">d49bf.</span></code><span class="number"><span lang="EN-US">.9247</span></span><code><span lang="EN-US">db6 </span></code><span class="number"><span lang="EN-US">100644</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">--- a/readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">+++ b/readme.txt<o:p></o:p></span></code></pre><pre><span class="decorator"><span lang="EN-US">@@ -1,2 +1,2 @@</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">-Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">+Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git diff</span></code>顾名思义就是查看<span lang="EN-US">difference</span>，显示的格式正是<span lang="EN-US">Unix</span>通用的<span lang="EN-US">diff</span>格式，可以从上面的命令输出看到，我们在第一行添加了一个<span lang="EN-US">&ldquo;distributed&rdquo;</span>单词。<span lang="EN-US"><o:p></o:p></span></p>

<p>知道了对<span lang="EN-US">readme.txt</span>作了什么修改后，再把它提交到仓库就放心多了，提交修改和提交新文件是一样的两步，第一步是<code><span lang="EN-US">git add</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt<o:p></o:p></span></code></pre>

<p>同样没有任何输出。在执行第二步<code><span lang="EN-US">git commit</span></code>之前，我们再运行<code><span lang="EN-US">git status</span></code>看看当前仓库的状态：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="">&nbsp;&nbsp;</span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git status</span></code>告诉我们，将要被提交的修改包括<span lang="EN-US">readme.txt</span>，下一步，就可以放心地提交了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"add distributed"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master ea34578] </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> distributed<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+), </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> deletion(-)<o:p></o:p></span></span></pre>

<p>提交后，我们再用<code><span lang="EN-US">git status</span></code>命令看看仓库的当前状态：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">nothing to commit (working directory clean)<o:p></o:p></span></code></pre>

<p><span lang="EN-US">Git</span>告诉我们当前没有需要提交的修改，而且，工作目录是干净（<span lang="EN-US">working
directory clean</span>）的。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->要随时掌握工作区的状态，使用<code><span lang="EN-US">git status</span></code>命令。<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->如果<code><span lang="EN-US">git status</span></code>告诉你有文件被修改过，用<code><span lang="EN-US">git diff</span></code>可以查看修改内容。<span lang="EN-US"><o:p></o:p></span></p>

<h3><a name="_版本回退"></a>版本回退<span lang="EN-US"><o:p></o:p></span></h3>

<p>现在，你已经学会了修改文件，然后把修改提交到<span lang="EN-US">Git</span>版本库，现在，再练习一次，修改<span lang="EN-US">readme.txt</span>文件如下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre>

<p>然后尝试提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"append GPL"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[master </span></code><span class="number"><span lang="EN-US">3628164</span></span><code><span lang="EN-US">] append </span></code><span class="constant"><span lang="EN-US">GPL</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+), </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> deletion(-)<o:p></o:p></span></code></pre>

<p>像这样，你不断对文件进行修改，然后不断提交修改到版本库里，就好比玩<span lang="EN-US">RPG</span>游戏时，每通过一关就会自动把游戏状态存盘，如果某一关没过去，你还可以选择读取前一关的状态。有些时候，在打<span lang="EN-US">Boss</span>之前，你会手动存盘，以便万一打<span lang="EN-US">Boss</span>失败了，可以从最近的地方重新开始。<span lang="EN-US">Git</span>也是一样，每当你觉得文件修改到一定程度的时候，就可以<span lang="EN-US">&ldquo;</span>保存一个快照<span lang="EN-US">&rdquo;</span>，这个快照在<span lang="EN-US">Git</span>中被称为<code><span lang="EN-US">commit</span></code>。一旦你把文件改乱了，或者误删了文件，还可以从最近的一个<code><span lang="EN-US">commit</span></code>恢复，然后继续工作，而不是把几个月的工作成果全部丢失。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，我们回顾一下<span lang="EN-US">readme.txt</span>文件一共有几个版本被提交到<span lang="EN-US">Git</span>仓库里了：<span lang="EN-US"><o:p></o:p></span></p>

<p>版本<span lang="EN-US">1</span>：<span lang="EN-US">wrote a readme file<o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p>版本<span lang="EN-US">2</span>：<span lang="EN-US">add distributed<o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p>版本<span lang="EN-US">3</span>：<span lang="EN-US">append GPL<o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre>

<p>当然了，在实际工作中，我们脑子里怎么可能记得一个几千行的文件每次都改了什么内容，不然要版本控制系统干什么。版本控制系统肯定有某个命令可以告诉我们历史记录，在<span lang="EN-US">Git</span>中，我们用<code><span lang="EN-US">git log</span></code>命令查看：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git log<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">commit 3628164fb26d48395383f8f31179f24e0882e1e0<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date: <span style="">&nbsp;&nbsp;</span>Tue Aug 20 15:11:49 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>append GPL<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US">commit ea34578d5496d7dd233c827ed32a8cd576c5ee85<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Tue Aug 20 14:53:12 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>add distributed<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US">commit cb926e7ea50ad11b8f9e909c05226233bf755030<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Mon Aug 19 17:51:55 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>wrote a readme file<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git log</span></code>命令显示从最近到最远的提交日志，我们可以看到<span lang="EN-US">3</span>次提交，最近的一次是<code><span lang="EN-US">append GPL</span></code>，上一次是<code><span lang="EN-US">add distributed</span></code>，最早的一次是<code><span lang="EN-US">wrote a
readme file</span></code>。 如果嫌输出信息太多，看得眼花缭乱的，可以试试加上<code><span lang="EN-US">--pretty=oneline</span></code>参数：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git log --pretty=oneline<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">3628164</span></span><code><span lang="EN-US">fb26d48395383f8f31179f24e0882e1e</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> append </span></code><span class="constant"><span lang="EN-US">GPL</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">ea34578d5496d7dd233c827ed32a8cd576c5ee85 add distributed<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">cb926e7ea50ad11b8f9e909c05226233bf75503</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> wrote a readme file<o:p></o:p></span></code></pre>

<p>需要友情提示的是，你看到的一大串类似<code><span lang="EN-US">3628164...882e1e0</span></code>的是<code><span lang="EN-US">commit id</span></code>（版本号），和<span lang="EN-US">SVN</span>不一样，<span lang="EN-US">Git</span>的<code><span lang="EN-US">commit id</span></code>不是<span lang="EN-US">1</span>，<span lang="EN-US">2</span>，<span lang="EN-US">3&hellip;&hellip;</span>递增的数字，而是一个<span lang="EN-US">SHA1</span>计算出来的一个非常大的数字，用十六进制表示，而且你看到的<code><span lang="EN-US">commit
id</span></code>和我的肯定不一样，以你自己的为准。为什么<code><span lang="EN-US">commit id</span></code>需要用这么一大串数字表示呢？因为<span lang="EN-US">Git</span>是分布式的版本控制系统，后面我们还要研究多人在同一个版本库里工作，如果大家都用<span lang="EN-US">1</span>，<span lang="EN-US">2</span>，<span lang="EN-US">3&hellip;&hellip;</span>作为版本号，那肯定就冲突了。<span lang="EN-US"><o:p></o:p></span></p>

<p>每提交一个新版本，实际上<span lang="EN-US">Git</span>就会把它们自动串成一条时间线。如果使用可视化工具查看<span lang="EN-US">Git</span>历史，就可以更清楚地看到提交历史的时间线：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_9"
 o:spid="_x0000_i1052" type="#_x0000_t75" alt="git-log-timeline" style='width:331.5pt;
 height:144.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image007.jpg"
  o:title="git-log-timeline"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image007.jpg" alt="git-log-timeline" v:shapes="图片_x0020_9" border="0" height="193" width="442"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>好了，现在我们启动时光穿梭机，准备把<span lang="EN-US">readme.txt</span>回退到上一个版本，也就是<span lang="EN-US">&ldquo;add distributed&rdquo;</span>的那个版本，怎么做呢？<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，<span lang="EN-US">Git</span>必须知道当前版本是哪个版本，在<span lang="EN-US">Git</span>中，用<code><span lang="EN-US">HEAD</span></code>表示当前版本，也就是最新的提交<code><span lang="EN-US">3628164...882e1e0</span></code>（注意我的提交<span lang="EN-US">ID</span>和你的肯定不一样），上一个版本就是<code><span lang="EN-US">HEAD^</span></code>，上上一个版本就是<code><span lang="EN-US">HEAD^^</span></code>，当然往上<span lang="EN-US">100</span>个版本写<span lang="EN-US">100</span>个<code><span lang="EN-US">^</span></code>比较容易数不过来，所以写成<code><span lang="EN-US">HEAD~100</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，我们要把当前版本<span lang="EN-US">&ldquo;append GPL&rdquo;</span>回退到上一个版本<span lang="EN-US">&ldquo;add
distributed&rdquo;</span>，就可以使用<code><span lang="EN-US">git reset</span></code>命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git re</span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> --hard HEAD^<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">HEAD </span></span><span class="keyword"><span lang="EN-US">is</span></span><span class="operator"><span lang="EN-US"> now </span></span><span class="keyword"><span lang="EN-US">at</span></span><span class="operator"><span lang="EN-US"> ea34578 </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> distributed<o:p></o:p></span></span></pre>

<p><code><span lang="EN-US">--hard</span></code>参数有啥意义？这个后面再讲，现在你先放心使用。<span lang="EN-US"><o:p></o:p></span></p>

<p>看看<span lang="EN-US">readme.txt</span>的内容是不是版本<code><span lang="EN-US">add
distributed</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software.<o:p></o:p></span></code></pre>

<p>果然。<span lang="EN-US"><o:p></o:p></span></p>

<p>还可以继续回退到上一个版本<code><span lang="EN-US">wrote a readme file</span></code>，不过且慢，然我们用<code><span lang="EN-US">git log</span></code>再看看现在版本库的状态：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git log<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">commit ea34578d5496d7dd233c827ed32a8cd576c5ee85<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Tue Aug 20 14:53:12 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>add distributed<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US">commit cb926e7ea50ad11b8f9e909c05226233bf755030<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Mon Aug 19 17:51:55 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>wrote a readme file<o:p></o:p></span></code></pre>

<p>最新的那个版本<code><span lang="EN-US">append GPL</span></code>已经看不到了！好比你从<span lang="EN-US">21</span>世纪坐时光穿梭机来到了<span lang="EN-US">19</span>世纪，想再回去已经回不去了，肿么办？<span lang="EN-US"><o:p></o:p></span></p>

<p>办法其实还是有的，只要上面的命令行窗口还没有被关掉，你就可以顺着往上找啊找啊，找到那个<code><span lang="EN-US">append GPL</span></code>的<code><span lang="EN-US">commit id</span></code>是<code><span lang="EN-US">3628164...</span></code>，于是就可以指定回到未来的某个版本：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git re</span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> --hard </span></span><span class="number"><span lang="EN-US">3628164</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">HEAD </span></span><span class="keyword"><span lang="EN-US">is</span></span><span class="operator"><span lang="EN-US"> now </span></span><span class="keyword"><span lang="EN-US">at</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">3628164</span></span><span class="operator"><span lang="EN-US"> append GPL<o:p></o:p></span></span></pre>

<p>版本号没必要写全，前几位就可以了，<span lang="EN-US">Git</span>会自动去找。当然也不能只写前一两位，因为<span lang="EN-US">Git</span>可能会找到多个版本号，就无法确定是哪一个了。<span lang="EN-US"><o:p></o:p></span></p>

<p>再小心翼翼地看看<span lang="EN-US">readme.txt</span>的内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre>

<p>果然，我胡汉三又回来了。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>的版本回退速度非常快，因为<span lang="EN-US">Git</span>在内部有个指向当前版本的<code><span lang="EN-US">HEAD</span></code>指针，当你回退版本的时候，<span lang="EN-US">Git</span>仅仅是把<span lang="EN-US">HEAD</span>从指向<code><span lang="EN-US">append GPL</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_8"
 o:spid="_x0000_i1051" type="#_x0000_t75" alt="git-head" style='width:176.25pt;
 height:121.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image008.jpg"
  o:title="git-head"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image008.jpg" alt="git-head" v:shapes="图片_x0020_8" border="0" height="162" width="235"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>改为指向<code><span lang="EN-US">add distributed</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_7"
 o:spid="_x0000_i1050" type="#_x0000_t75" alt="git-head-move" style='width:176.25pt;
 height:121.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image009.jpg"
  o:title="git-head-move"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image009.jpg" alt="git-head-move" v:shapes="图片_x0020_7" border="0" height="162" width="235"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>然后顺便把工作区的文件更新了。所以你让<code><span lang="EN-US">HEAD</span></code>指向哪个版本号，你就把当前版本定位在哪。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，你回退到了某个版本，关掉了电脑，第二天早上就后悔了，想恢复到新版本怎么办？找不到新版本的<code><span lang="EN-US">commit
id</span></code>怎么办？<span lang="EN-US"><o:p></o:p></span></p>

<p>在<span lang="EN-US">Git</span>中，总是有后悔药可以吃的。当你用<code><span lang="EN-US">$ git
reset --hard HEAD^</span></code>回退到<code><span lang="EN-US">add distributed</span></code>版本时，再想恢复到<code><span lang="EN-US">append GPL</span></code>，就必须找到<code><span lang="EN-US">append GPL</span></code>的<span lang="EN-US">commit id</span>。<span lang="EN-US">Git</span>提供了一个命令<code><span lang="EN-US">git reflog</span></code>用来记录你的每一次命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ </span></code><span class="tag"><span lang="EN-US">git</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">reflog</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="tag"><span lang="EN-US">ea34578</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">HEAD</span></span><span class="atrule"><span lang="EN-US">@</span></span><code><span lang="EN-US">{0}: </span></code><span class="tag"><span lang="EN-US">reset</span></span><code><span lang="EN-US">: </span></code><span class="tag"><span lang="EN-US">moving</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">to</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">HEAD</span></span><code><span lang="EN-US">^<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">3628164 </span></code><span class="tag"><span lang="EN-US">HEAD</span></span><span class="atrule"><span lang="EN-US">@</span></span><code><span lang="EN-US">{1}: </span></code><span class="tag"><span lang="EN-US">commit</span></span><code><span lang="EN-US">: </span></code><span class="tag"><span lang="EN-US">append</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">GPL</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="tag"><span lang="EN-US">ea34578</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">HEAD</span></span><span class="atrule"><span lang="EN-US">@</span></span><code><span lang="EN-US">{2}: </span></code><span class="tag"><span lang="EN-US">commit</span></span><code><span lang="EN-US">: </span></code><span class="tag"><span lang="EN-US">add</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">distributed</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="tag"><span lang="EN-US">cb926e7</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">HEAD</span></span><span class="atrule"><span lang="EN-US">@</span></span><code><span lang="EN-US">{3}: </span></code><span class="tag"><span lang="EN-US">commit</span></span><code><span lang="EN-US"> (</span></code><span class="tag"><span lang="EN-US">initial</span></span><code><span lang="EN-US">): </span></code><span class="tag"><span lang="EN-US">wrote</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">a</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">readme</span></span><code><span lang="EN-US"> </span></code><span class="tag"><span lang="EN-US">file</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>终于舒了口气，第二行显示<code><span lang="EN-US">append GPL</span></code>的<span lang="EN-US">commit id</span>是<code><span lang="EN-US">3628164</span></code>，现在，你又可以乘坐时光机回到未来了。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>现在总结一下：<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><code><span lang="EN-US">HEAD</span></code>指向的版本就是当前版本，因此，<span lang="EN-US">Git</span>允许我们在版本的历史之间穿梭，使用命令<code><span lang="EN-US">git reset --hard
commit_id</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->穿梭前，用<code><span lang="EN-US">git log</span></code>可以查看提交历史，以便确定要回退到哪个版本。<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->要重返未来，用<code><span lang="EN-US">git reflog</span></code>查看命令历史，以便确定要回到未来的哪个版本。<span lang="EN-US"><o:p></o:p></span></p>

<h3>工作区和暂存区<span lang="EN-US"><o:p></o:p></span></h3>

<p><span lang="EN-US">Git</span>和其他版本控制系统如<span lang="EN-US">SVN</span>的一个不同之处就是有暂存区的概念。<span lang="EN-US"><o:p></o:p></span></p>

<p>先来看名词解释。<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E5-B7-A5-E4-BD-9C-E5-8C-BA-EF-BC-88Wor"></a><span style="font-family: 宋体;">工作区（</span><span lang="EN-US">Working Directory</span><span style="font-family: 宋体;">）</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>就是你在电脑里能看到的目录，比如我的<code><span lang="EN-US">learngit</span></code>文件夹就是一个工作区：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_13"
 o:spid="_x0000_i1049" type="#_x0000_t75" alt="working-dir" style='width:466.5pt;
 height:4in;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image010.png"
  o:title="working-dir"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image010.png" alt="working-dir" v:shapes="图片_x0020_13" border="0" height="384" width="622"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E7-89-88-E6-9C-AC-E5-BA-93-EF-BC-88Rep"></a><span style="font-family: 宋体;">版本库（</span><span lang="EN-US">Repository</span><span style="font-family: 宋体;">）</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>工作区有一个隐藏目录<code><span lang="EN-US">.git</span></code>，这个不算工作区，而是<span lang="EN-US">Git</span>的版本库。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>的版本库里存了很多东西，其中最重要的就是称为<span lang="EN-US">stage</span>（或者叫<span lang="EN-US">index</span>）的暂存区，还有<span lang="EN-US">Git</span>为我们自动创建的第一个分支<code><span lang="EN-US">master</span></code>，以及指向<code><span lang="EN-US">master</span></code>的一个指针叫<code><span lang="EN-US">HEAD</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_12"
 o:spid="_x0000_i1048" type="#_x0000_t75" alt="git-repo" style='width:343.5pt;
 height:175.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image011.jpg"
  o:title="git-repo"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image011.jpg" alt="git-repo" v:shapes="图片_x0020_12" border="0" height="234" width="458"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>分支和<code><span lang="EN-US">HEAD</span></code>的概念我们以后再讲。<span lang="EN-US"><o:p></o:p></span></p>

<p>前面讲了我们把文件往<span lang="EN-US">Git</span>版本库里添加的时候，是分两步执行的：<span lang="EN-US"><o:p></o:p></span></p>

<p>第一步是用<code><span lang="EN-US">git add</span></code>把文件添加进去，实际上就是把文件修改添加到暂存区；<span lang="EN-US"><o:p></o:p></span></p>

<p>第二步是用<code><span lang="EN-US">git commit</span></code>提交更改，实际上就是把暂存区的所有内容提交到当前分支。<span lang="EN-US"><o:p></o:p></span></p>

<p>因为我们创建<span lang="EN-US">Git</span>版本库时，<span lang="EN-US">Git</span>自动为我们创建了唯一一个<code><span lang="EN-US">master</span></code>分支，所以，现在，<code><span lang="EN-US">git commit</span></code>就是往<code><span lang="EN-US">master</span></code>分支上提交更改。<span lang="EN-US"><o:p></o:p></span></p>

<p>你可以简单理解为，需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。<span lang="EN-US"><o:p></o:p></span></p>

<p>俗话说，实践出真知。现在，我们再练习一遍，先对<code><span lang="EN-US">readme.txt</span></code>做个修改，比如加上一行内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre>

<p>然后，在工作区新增一个<code><span lang="EN-US">LICENSE</span></code>文本文件（内容随便写）。<span lang="EN-US"><o:p></o:p></span></p>

<p>先用<code><span lang="EN-US">git status</span></code>查看一下状态：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Untracked files:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to include in what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LICENSE</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p><span lang="EN-US">Git</span>非常清楚地告诉我们，<code><span lang="EN-US">readme.txt</span></code>被修改了，而<code><span lang="EN-US">LICENSE</span></code>还从来没有被添加过，所以它的状态是<code><span lang="EN-US">Untracked</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，使用两次命令<code><span lang="EN-US">git add</span></code>，把<code><span lang="EN-US">readme.txt</span></code>和<code><span lang="EN-US">LICENSE</span></code>都添加后，用<code><span lang="EN-US">git status</span></code>再查看一下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>new file:<span style="">&nbsp;&nbsp; </span>LICENSE</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>现在，暂存区的状态就变成这样了：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_11"
 o:spid="_x0000_i1047" type="#_x0000_t75" alt="git-stage" style='width:343.5pt;
 height:175.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image012.jpg"
  o:title="git-stage"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image012.jpg" alt="git-stage" v:shapes="图片_x0020_11" border="0" height="234" width="458"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>所以，<code><span lang="EN-US">git add</span></code>命令实际上就是把要提交的所有修改放到暂存区（<span lang="EN-US">Stage</span>），然后，执行<code><span lang="EN-US">git commit</span></code>就可以一次性把暂存区的所有修改提交到分支。<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"understand how stage works"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master </span></span><span class="number"><span lang="EN-US">27</span></span><span class="operator"><span lang="EN-US">c9860] understand how stage works<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">2</span></span><span class="operator"><span lang="EN-US"> files changed, </span></span><span class="number"><span lang="EN-US">675</span></span><span class="operator"><span lang="EN-US"> insertions(+)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">create</span></span><span class="operator"><span lang="EN-US"> mode </span></span><span class="number"><span lang="EN-US">100644</span></span><span class="operator"><span lang="EN-US"> LICENSE<o:p></o:p></span></span></pre>

<p>一旦提交后，如果你又没有对工作区做任何修改，那么工作区就是<span lang="EN-US">&ldquo;</span>干净<span lang="EN-US">&rdquo;</span>的：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">nothing to commit (working directory clean)<o:p></o:p></span></code></pre>

<p>现在版本库变成了这样，暂存区就没有任何内容了：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_10"
 o:spid="_x0000_i1046" type="#_x0000_t75" alt="git-stage-after-commit" style='width:347.25pt;
 height:175.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image013.jpg"
  o:title="git-stage-after-commit"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image013.jpg" alt="git-stage-after-commit" v:shapes="图片_x0020_10" border="0" height="234" width="463"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>暂存区是<span lang="EN-US">Git</span>非常重要的概念，弄明白了暂存区，就弄明白了<span lang="EN-US">Git</span>的很多操作到底干了什么。<span lang="EN-US"><o:p></o:p></span></p>

<p>没弄明白暂存区是怎么回事的童鞋，请向上滚动页面，再看一次。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<h3>管理修改<span lang="EN-US"><o:p></o:p></span></h3>

<p>现在，假定你已经完全掌握了暂存区的概念。下面，我们要讨论的就是，为什么<span lang="EN-US">Git</span>比其他版本控制系统设计得优秀，因为<span lang="EN-US">Git</span>跟踪并管理的是修改，而非文件。<span lang="EN-US"><o:p></o:p></span></p>

<p>你会问，什么是修改？比如你新增了一行，这就是一个修改，删除了一行，也是一个修改，更改了某些字符，也是一个修改，删了一些又加了一些，也是一个修改，甚至创建一个新文件，也算一个修改。<span lang="EN-US"><o:p></o:p></span></p>

<p>为什么说<span lang="EN-US">Git</span>管理的是修改，而不是文件呢？我们还是做实验。第一步，对<span lang="EN-US">readme.txt</span>做一个修改，比如加一行内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git tracks changes.<o:p></o:p></span></code></pre>

<p>然后，添加：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp; </span><span style="">&nbsp;</span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>然后，再修改<span lang="EN-US">readme.txt</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git tracks changes of files.<o:p></o:p></span></code></pre>

<p>提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"git tracks changes"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master d4f25b6] git tracks changes<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+)<o:p></o:p></span></span></pre>

<p>提交后，再看看状态：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>咦，怎么第二次的修改没有被提交？<span lang="EN-US"><o:p></o:p></span></p>

<p>别激动，我们回顾一下操作过程：<span lang="EN-US"><o:p></o:p></span></p>

<p>第一次修改<span lang="EN-US"> -&gt; <code>git add</code> -&gt; </span>第二次修改<span lang="EN-US"> -&gt; <code>git commit</code><o:p></o:p></span></p>

<p>你看，我们前面讲了，<span lang="EN-US">Git</span>管理的是修改，当你用<code><span lang="EN-US">git
add</span></code>命令后，在工作区的第一次修改被放入暂存区，准备提交，但是，在工作区的第二次修改并没有放入暂存区，所以，<code><span lang="EN-US">git commit</span></code>只负责把暂存区的修改提交了，也就是第一次的修改被提交了，第二次的修改不会被提交。<span lang="EN-US"><o:p></o:p></span></p>

<p>提交后，用<code><span lang="EN-US">git diff HEAD -- readme.txt</span></code>命令可以查看工作区和版本库里面最新版本的区别：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git diff HEAD -- readme.txt <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">diff --git a/readme.txt b/readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">index </span></code><span class="number"><span lang="EN-US">76</span></span><code><span lang="EN-US">d770f..a9c5755 </span></code><span class="number"><span lang="EN-US">100644</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">--- a/readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">+++ b/readme.txt<o:p></o:p></span></code></pre><pre><span class="decorator"><span lang="EN-US">@@ -1,4 +1,4 @@</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">-Git tracks changes.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">+Git tracks changes of files.<o:p></o:p></span></code></pre>

<p>可见，第二次修改确实没有被提交。<span lang="EN-US"><o:p></o:p></span></p>

<p>那怎么提交第二次修改呢？你可以继续<code><span lang="EN-US">git add</span></code>再<code><span lang="EN-US">git commit</span></code>，也可以别着急提交第一次修改，先<code><span lang="EN-US">git
add</span></code>第二次修改，再<code><span lang="EN-US">git commit</span></code>，就相当于把两次修改合并后一块提交了：<span lang="EN-US"><o:p></o:p></span></p>

<p>第一次修改<span lang="EN-US"> -&gt; <code>git add</code> -&gt; </span>第二次修改<span lang="EN-US"> -&gt; <code>git add</code> -&gt; <code>git commit</code><o:p></o:p></span></p>

<p>好，现在，把第二次修改提交了，然后开始小结。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>现在，你又理解了<span lang="EN-US">Git</span>是如何跟踪修改的，每次修改，如果不<code><span lang="EN-US">add</span></code>到暂存区，那就不会加入到<code><span lang="EN-US">commit</span></code>中。<span lang="EN-US"><o:p></o:p></span></p>

<h3><a name="_撤销修改"></a>撤销修改<span lang="EN-US"><o:p></o:p></span></h3>

<p>自然，你是不会犯错的。不过现在是凌晨两点，你正在赶一份工作报告，你在<code><span lang="EN-US">readme.txt</span></code>中添加了一行：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git tracks changes of files.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">My stupid boss still prefers SVN.<o:p></o:p></span></code></pre>

<p>在你准备提交前，一杯咖啡起了作用，你猛然发现了<span lang="EN-US">&ldquo;stupid boss&rdquo;</span>可能会让你丢掉这个月的奖金！<span lang="EN-US"><o:p></o:p></span></p>

<p>既然错误发现得很及时，就可以很容易地纠正它。你可以删掉最后一行，手动把文件恢复到上一个版本的状态。如果用<code><span lang="EN-US">git
status</span></code>查看一下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>你可以发现，<span lang="EN-US">Git</span>会告诉你，<code><span lang="EN-US">git checkout --
file</span></code>可以丢弃工作区的修改：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -- readme.txt<o:p></o:p></span></code></pre>

<p>命令<code><span lang="EN-US">git checkout -- readme.txt</span></code>意思就是，把<code><span lang="EN-US">readme.txt</span></code>文件在工作区的修改全部撤销，这里有两种情况：<span lang="EN-US"><o:p></o:p></span></p>

<p>一种是<code><span lang="EN-US">readme.txt</span></code>自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；<span lang="EN-US"><o:p></o:p></span></p>

<p>一种是<code><span lang="EN-US">readme.txt</span></code>已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。<span lang="EN-US"><o:p></o:p></span></p>

<p>总之，就是让这个文件回到最近一次<code><span lang="EN-US">git commit</span></code>或<code><span lang="EN-US">git add</span></code>时的状态。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，看看<code><span lang="EN-US">readme.txt</span></code>的文件内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ cat readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git </span></code><span class="keyword"><span lang="EN-US">is</span></span><code><span lang="EN-US"> free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git tracks changes of files.<o:p></o:p></span></code></pre>

<p>文件内容果然复原了。<span lang="EN-US"><o:p></o:p></span></p>

<p><code><span lang="EN-US">git checkout -- file</span></code>命令中的<code><span lang="EN-US">--</span></code>很重要，没有<code><span lang="EN-US">--</span></code>，就变成了<span lang="EN-US">&ldquo;</span>切换到另一个分支<span lang="EN-US">&rdquo;</span>的命令，我们在后面的分支管理中会再次遇到<code><span lang="EN-US">git checkout</span></code>命令。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在假定是凌晨<span lang="EN-US">3</span>点，你不但写了一些胡话，还<code><span lang="EN-US">git add</span></code>到暂存区了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">cat readme.txt<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Git</span></span><code><span lang="EN-US"> is a distributed version control system.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Git</span></span><code><span lang="EN-US"> is free software distributed under the </span></code><span class="constant"><span lang="EN-US">GPL</span></span><code><span lang="EN-US">.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Git</span></span><code><span lang="EN-US"> has a mutable index called stage.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Git</span></span><code><span lang="EN-US"> tracks changes of files.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">My</span></span><code><span lang="EN-US"> stupid boss still prefers </span></code><span class="constant"><span lang="EN-US">SVN</span></span><code><span lang="EN-US">.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt<o:p></o:p></span></code></pre>

<p>庆幸的是，在<code><span lang="EN-US">commit</span></code>之前，你发现了这个问题。用<code><span lang="EN-US">git status</span></code>查看一下，修改只是添加到了暂存区，还没有提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><span lang="EN-US">Git</span>同样告诉我们，用命令<code><span lang="EN-US">git reset HEAD
file</span></code>可以把暂存区的修改撤销掉（<span lang="EN-US">unstage</span>），重新放回工作区：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git re</span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> HEAD readme.txt<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Unstaged changes after reset:<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">M<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>readme.txt<o:p></o:p></span></span></pre>

<p><code><span lang="EN-US">git reset</span></code>命令既可以回退版本，也可以把暂存区的修改回退到工作区。当我们用<code><span lang="EN-US">HEAD</span></code>时，表示最新的版本。<span lang="EN-US"><o:p></o:p></span></p>

<p>再用<code><span lang="EN-US">git status</span></code>查看一下，现在暂存区是干净的，工作区有修改：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>还记得如何丢弃工作区的修改吗？<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -- readme.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">nothing to commit (working directory clean)<o:p></o:p></span></code></pre>

<p>整个世界终于清静了！<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，假设你不但改错了东西，还从暂存区提交到了版本库，怎么办呢？还记得<span lang="EN-US"><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013744142037508cf42e51debf49668810645e02887691000" target="_blank"><span lang="EN-US"><span lang="EN-US">版本回退</span></span></a></span>一节吗？可以回退到上一个版本。不过，这是有条件的，就是你还没有把自己的本地版本库推送到远程。还记得<span lang="EN-US">Git</span>是分布式版本控制系统吗？我们后面会讲到远程版本库，一旦你把<span lang="EN-US">&ldquo;stupid
boss&rdquo;</span>提交推送到远程版本库，你就真的惨了<span lang="EN-US">&hellip;&hellip;<o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>又到了小结时间。<span lang="EN-US"><o:p></o:p></span></p>

<p>场景<span lang="EN-US">1</span>：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令<code><span lang="EN-US">git checkout -- file</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>场景<span lang="EN-US">2</span>：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令<code><span lang="EN-US">git reset HEAD file</span></code>，就回到了场景<span lang="EN-US">1</span>，第二步按场景<span lang="EN-US">1</span>操作。<span lang="EN-US"><o:p></o:p></span></p>

<p>场景<span lang="EN-US">3</span>：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考<span lang="EN-US"><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013744142037508cf42e51debf49668810645e02887691000" target="_blank"><span lang="EN-US"><span lang="EN-US">版本回退</span></span></a></span>一节，不过前提是没有推送到远程库。<span lang="EN-US"><o:p></o:p></span></p>

<h3>删除文件<span lang="EN-US"><o:p></o:p></span></h3>

<p>在<span lang="EN-US">Git</span>中，删除也是一个修改操作，我们实战一下，先添加一个新文件<span lang="EN-US">test.txt</span>到<span lang="EN-US">Git</span>并且提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git add test.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"add test.txt"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master </span></span><span class="number"><span lang="EN-US">94</span></span><span class="operator"><span lang="EN-US">cdc44] </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> test.txt<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">create</span></span><span class="operator"><span lang="EN-US"> mode </span></span><span class="number"><span lang="EN-US">100644</span></span><span class="operator"><span lang="EN-US"> test.txt<o:p></o:p></span></span></pre>

<p>一般情况下，你通常直接在文件管理器中把没用的文件删了，或者用<code><span lang="EN-US">rm</span></code>命令删了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">rm test.txt<o:p></o:p></span></code></pre>

<p>这个时候，<span lang="EN-US">Git</span>知道你删除了文件，因此，工作区和版本库就不一致了，<code><span lang="EN-US">git status</span></code>命令会立刻告诉你哪些文件被删除了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add/rm &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>deleted:<span style="">&nbsp;&nbsp;&nbsp; </span>test.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>现在你有两个选择，一是确实要从版本库中删除该文件，那就用命令<code><span lang="EN-US">git rm</span></code>删掉，并且<code><span lang="EN-US">git commit</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git rm test.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">rm 'test.txt'<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"remove test.txt"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[master d17efd8] remove test.txt<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> deletion(-)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">delete</span></span><span class="operator"><span lang="EN-US"> mode </span></span><span class="number"><span lang="EN-US">100644</span></span><span class="operator"><span lang="EN-US"> test.txt<o:p></o:p></span></span></pre>

<p>现在，文件就从版本库中被删除了。<span lang="EN-US"><o:p></o:p></span></p>

<p>另一种情况是删错了，因为版本库里还有呢，所以可以很轻松地把误删的文件恢复到最新版本：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -- test.txt<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git checkout</span></code>其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以<span lang="EN-US">&ldquo;</span>一键还原<span lang="EN-US">&rdquo;</span>。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>命令<code><span lang="EN-US">git rm</span></code>用于删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失<strong><span style="font-family: 宋体;">最近一次提交后你修改的内容</span></strong>。<span lang="EN-US"><o:p></o:p></span></p>

<h2><a name="_远程仓库"></a><span style="font-family: 宋体;">远程仓库</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>到目前为止，我们已经掌握了如何在<span lang="EN-US">Git</span>仓库里对一个文件进行时光穿梭，你再也不用担心文件备份或者丢失的问题了。<span lang="EN-US"><o:p></o:p></span></p>

<p>可是有用过集中式版本控制系统<span lang="EN-US">SVN</span>的童鞋会站出来说，这些功能在<span lang="EN-US">SVN</span>里早就有了，没看出<span lang="EN-US">Git</span>有什么特别的地方。<span lang="EN-US"><o:p></o:p></span></p>

<p>没错，如果只是在一个仓库里管理文件历史，<span lang="EN-US">Git</span>和<span lang="EN-US">SVN</span>真没啥区别。为了保证你现在所学的<span lang="EN-US">Git</span>物超所值，将来绝对不会后悔，同时为了打击已经不幸学了<span lang="EN-US">SVN</span>的童鞋，本章开始介绍<span lang="EN-US">Git</span>的杀手级功能之一（注意是之一，也就是后面还有之二，之三<span lang="EN-US">&hellip;&hellip;</span>）：远程仓库。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>是分布式版本控制系统，同一个<span lang="EN-US">Git</span>仓库，可以分布到不同的机器上。怎么分布呢？最早，肯定只有一台机器有一个原始版本库，此后，别的机器可以<span lang="EN-US">&ldquo;</span>克隆<span lang="EN-US">&rdquo;</span>这个原始版本库，而且每台机器的版本库其实都是一样的，并没有主次之分。<span lang="EN-US"><o:p></o:p></span></p>

<p>你肯定会想，至少需要两台机器才能玩远程库不是？但是我只有一台电脑，怎么玩？<span lang="EN-US"><o:p></o:p></span></p>

<p>其实一台电脑上也是可以克隆多个版本库的，只要不在同一个目录下。不过，现实生活中是不会有人这么傻的在一台电脑上搞几个远程库玩，因为一台电脑上搞几个远程库完全没有意义，而且硬盘挂了会导致所有库都挂掉，所以我也不告诉你在一台电脑上怎么克隆多个仓库。<span lang="EN-US"><o:p></o:p></span></p>

<p>实际情况往往是这样，找一台电脑充当服务器的角色，每天<span lang="EN-US">24</span>小时开机，其他每个人都从这个<span lang="EN-US">&ldquo;</span>服务器<span lang="EN-US">&rdquo;</span>仓库克隆一份到自己的电脑上，并且各自把各自的提交推送到服务器仓库里，也从服务器仓库中拉取别人的提交。<span lang="EN-US"><o:p></o:p></span></p>

<p>完全可以自己搭建一台运行<span lang="EN-US">Git</span>的服务器，不过现阶段，为了学<span lang="EN-US">Git</span>先搭个服务器绝对是小题大作。好在这个世界上有个叫<span lang="EN-US"><a href="https://github.com/" target="_blank">GitHub</a></span>的神奇的网站，从名字就可以看出，这个网站就是提供<span lang="EN-US">Git</span>仓库托管服务的，所以，只要注册一个<span lang="EN-US">GitHub</span>账号，就可以免费获得<span lang="EN-US">Git</span>远程仓库。<span lang="EN-US"><o:p></o:p></span></p>

<p>在继续阅读后续内容前，请自行注册<span lang="EN-US">GitHub</span>账号。由于你的本地<span lang="EN-US">Git</span>仓库和<span lang="EN-US">GitHub</span>仓库之间的传输是通过<span lang="EN-US">SSH</span>加密的，所以，需要一点设置：<span lang="EN-US"><o:p></o:p></span></p>

<p>第<span lang="EN-US">1</span>步：创建<span lang="EN-US">SSH Key</span>。在用户主目录下，看看有没有<span lang="EN-US">.ssh</span>目录，如果有，再看看这个目录下有没有<code><span lang="EN-US">id_rsa</span></code>和<code><span lang="EN-US">id_rsa.pub</span></code>这两个文件，如果已经有了，可直接跳到下一步。如果没有，打开<span lang="EN-US">Shell</span>（<span lang="EN-US">Windows</span>下打开<span lang="EN-US">Git
Bash</span>），创建<span lang="EN-US">SSH Key</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">ssh-keygen -t rsa -</span></code><span class="constant"><span lang="EN-US">C</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"youremail@example.com"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>你需要把邮件地址换成你自己的邮件地址，然后一路回车，使用默认值即可，由于这个<span lang="EN-US">Key</span>也不是用于军事目的，所以也无需设置密码。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果一切顺利的话，可以在用户主目录里找到<code><span lang="EN-US">.ssh</span></code>目录，里面有<code><span lang="EN-US">id_rsa</span></code>和<code><span lang="EN-US">id_rsa.pub</span></code>两个文件，这两个就是<span lang="EN-US">SSH Key</span>的秘钥对，<code><span lang="EN-US">id_rsa</span></code>是私钥，不能泄露出去，<code><span lang="EN-US">id_rsa.pub</span></code>是公钥，可以放心地告诉任何人。<span lang="EN-US"><o:p></o:p></span></p>

<p>第<span lang="EN-US">2</span>步：登陆<span lang="EN-US">GitHub</span>，打开<span lang="EN-US">&ldquo;Account settings&rdquo;</span>，<span lang="EN-US">&ldquo;SSH Keys&rdquo;</span>页面：<span lang="EN-US"><o:p></o:p></span></p>

<p>然后，点<span lang="EN-US">&ldquo;Add SSH Key&rdquo;</span>，填上任意<span lang="EN-US">Title</span>，在<span lang="EN-US">Key</span>文本框里粘贴<code><span lang="EN-US">id_rsa.pub</span></code>文件的内容：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_15"
 o:spid="_x0000_i1045" type="#_x0000_t75" alt="github-addkey-1" style='width:331.5pt;
 height:213pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image014.png"
  o:title="github-addkey-1"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image014.png" alt="github-addkey-1" v:shapes="图片_x0020_15" border="0" height="284" width="442"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>点<span lang="EN-US">&ldquo;Add Key&rdquo;</span>，你就应该看到已经添加的<span lang="EN-US">Key</span>：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_14"
 o:spid="_x0000_i1044" type="#_x0000_t75" alt="github-addkey-2" style='width:331.5pt;
 height:160.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image015.png"
  o:title="github-addkey-2"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image015.png" alt="github-addkey-2" v:shapes="图片_x0020_14" border="0" height="214" width="442"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>为什么<span lang="EN-US">GitHub</span>需要<span lang="EN-US">SSH Key</span>呢？因为<span lang="EN-US">GitHub</span>需要识别出你推送的提交确实是你推送的，而不是别人冒充的，而<span lang="EN-US">Git</span>支持<span lang="EN-US">SSH</span>协议，所以，<span lang="EN-US">GitHub</span>只要知道了你的公钥，就可以确认只有你自己才能推送。<span lang="EN-US"><o:p></o:p></span></p>

<p>当然，<span lang="EN-US">GitHub</span>允许你添加多个<span lang="EN-US">Key</span>。假定你有若干电脑，你一会儿在公司提交，一会儿在家里提交，只要把每台电脑的<span lang="EN-US">Key</span>都添加到<span lang="EN-US">GitHub</span>，就可以在每台电脑上往<span lang="EN-US">GitHub</span>推送了。<span lang="EN-US"><o:p></o:p></span></p>

<p>最后友情提示，在<span lang="EN-US">GitHub</span>上免费托管的<span lang="EN-US">Git</span>仓库，任何人都可以看到喔（但只有你自己才能改）。所以，不要把敏感信息放进去。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你不想让别人看到<span lang="EN-US">Git</span>库，有两个办法，一个是交点保护费，让<span lang="EN-US">GitHub</span>把公开的仓库变成私有的，这样别人就看不见了（不可读更不可写）。另一个办法是自己动手，搭一个<span lang="EN-US">Git</span>服务器，因为是你自己的<span lang="EN-US">Git</span>服务器，所以别人也是看不见的。这个方法我们后面会讲到的，相当简单，公司内部开发必备。<span lang="EN-US"><o:p></o:p></span></p>

<p>确保你拥有一个<span lang="EN-US">GitHub</span>账号后，我们就即将开始远程仓库的学习。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p><span lang="EN-US">&ldquo;</span>有了远程仓库，妈妈再也不用担心我的硬盘了。<span lang="EN-US">&rdquo;&mdash;&mdash;Git</span>点读机<span lang="EN-US"><o:p></o:p></span></p>

<h3>添加远程库<span lang="EN-US"><o:p></o:p></span></h3>

<p>现在的情景是，你已经在本地创建了一个<span lang="EN-US">Git</span>仓库后，又想在<span lang="EN-US">GitHub</span>创建一个<span lang="EN-US">Git</span>仓库，并且让这两个仓库进行远程同步，这样，<span lang="EN-US">GitHub</span>上的仓库既可以作为备份，又可以让其他人通过该仓库来协作，真是一举多得。<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，登陆<span lang="EN-US">GitHub</span>，然后，在右上角找到<span lang="EN-US">&ldquo;Create a new
repo&rdquo;</span>按钮，创建一个新的仓库：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_18"
 o:spid="_x0000_i1043" type="#_x0000_t75" alt="github-create-repo-1" style='width:328.5pt;
 height:201pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image016.png"
  o:title="github-create-repo-1"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image016.png" alt="github-create-repo-1" v:shapes="图片_x0020_18" border="0" height="268" width="438"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>在<span lang="EN-US">Repository name</span>填入<code><span lang="EN-US">learngit</span></code>，其他保持默认设置，点击<span lang="EN-US">&ldquo;Create repository&rdquo;</span>按钮，就成功地创建了一个新的<span lang="EN-US">Git</span>仓库：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_17"
 o:spid="_x0000_i1042" type="#_x0000_t75" alt="github-create-repo-2" style='width:328.5pt;
 height:242.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image017.png"
  o:title="github-create-repo-2"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image017.png" alt="github-create-repo-2" v:shapes="图片_x0020_17" border="0" height="323" width="438"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>目前，在<span lang="EN-US">GitHub</span>上的这个<code><span lang="EN-US">learngit</span></code>仓库还是空的，<span lang="EN-US">GitHub</span>告诉我们，可以从这个仓库克隆出新的仓库，也可以把一个已有的本地仓库与之关联，然后，把本地仓库的内容推送到<span lang="EN-US">GitHub</span>仓库。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，我们根据<span lang="EN-US">GitHub</span>的提示，在本地的<code><span lang="EN-US">learngit</span></code>仓库下运行命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git remote add origin git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git<o:p></o:p></span></code></pre>

<p>请千万注意，把上面的<code><span lang="EN-US">michaelliao</span></code>替换成你自己的<span lang="EN-US">GitHub</span>账户名，否则，你在本地关联的就是我的远程库，关联没有问题，但是你以后推送是推不上去的，因为你的<span lang="EN-US">SSH Key</span>公钥不在我的账户列表中。<span lang="EN-US"><o:p></o:p></span></p>

<p>添加后，远程库的名字就是<code><span lang="EN-US">origin</span></code>，这是<span lang="EN-US">Git</span>默认的叫法，也可以改成别的，但是<code><span lang="EN-US">origin</span></code>这个名字一看就知道是远程库。<span lang="EN-US"><o:p></o:p></span></p>

<p>下一步，就可以把本地库的所有内容推送到远程库上：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git push -u origin master<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Counting objects: 19, done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Delta compression using up to 4 threads.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Compressing objects: 100% (19/19), done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Writing objects: 100% (19/19), 13.73 KiB, done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Total 23 (delta 6), reused 0 (delta 0)<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">To git@github.com:michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> * [new branch]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>master -&gt; master<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Branch master </span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> up </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> track remote branch master </span></span><span class="keyword"><span lang="EN-US">from</span></span><span class="operator"><span lang="EN-US"> origin.<o:p></o:p></span></span></pre>

<p>把本地库的内容推送到远程，用<code><span lang="EN-US">git push</span></code>命令，实际上是把当前分支<code><span lang="EN-US">master</span></code>推送到远程。<span lang="EN-US"><o:p></o:p></span></p>

<p>由于远程库是空的，我们第一次推送<code><span lang="EN-US">master</span></code>分支时，加上了<code><span lang="EN-US">-u</span></code>参数，<span lang="EN-US">Git</span>不但会把本地的<code><span lang="EN-US">master</span></code>分支内容推送的远程新的<code><span lang="EN-US">master</span></code>分支，还会把本地的<code><span lang="EN-US">master</span></code>分支和远程的<code><span lang="EN-US">master</span></code>分支关联起来，在以后的推送或者拉取时就可以简化命令。<span lang="EN-US"><o:p></o:p></span></p>

<p>推送成功后，可以立刻在<span lang="EN-US">GitHub</span>页面中看到远程库的内容已经和本地一模一样：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_16"
 o:spid="_x0000_i1041" type="#_x0000_t75" alt="github-repo" style='width:309pt;
 height:219pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image018.png"
  o:title="github-repo"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image018.png" alt="github-repo" v:shapes="图片_x0020_16" border="0" height="292" width="412"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>从现在起，只要本地作了提交，就可以通过命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git push origin master<o:p></o:p></span></code></pre>

<p>把本地<code><span lang="EN-US">master</span></code>分支的最新修改推送至<span lang="EN-US">GitHub</span>，现在，你就拥有了真正的分布式版本库！<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#SSH-E8-AD-A6-E5-91-8A"></a><span lang="EN-US">SSH</span><span style="font-family: 宋体;">警告</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>当你第一次使用<span lang="EN-US">Git</span>的<code><span lang="EN-US">clone</span></code>或者<code><span lang="EN-US">push</span></code>命令连接<span lang="EN-US">GitHub</span>时，会得到一个警告：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">The authenticity of host 'github.com (xx.xx.xx.xx)' can't be established.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">RSA key fingerprint is xx.xx.xx.xx.xx.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Are you sure you want to continue connecting (yes/no)?<o:p></o:p></span></code></pre>

<p>这是因为<span lang="EN-US">Git</span>使用<span lang="EN-US">SSH</span>连接，而<span lang="EN-US">SSH</span>连接在第一次验证<span lang="EN-US">GitHub</span>服务器的<span lang="EN-US">Key</span>时，需要你确认<span lang="EN-US">GitHub</span>的<span lang="EN-US">Key</span>的指纹信息是否真的来自<span lang="EN-US">GitHub</span>的服务器，输入<code><span lang="EN-US">yes</span></code>回车即可。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>会输出一个警告，告诉你已经把<span lang="EN-US">GitHub</span>的<span lang="EN-US">Key</span>添加到本机的一个信任列表里了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Warning: Permanently added </span></code><span class="string"><span lang="EN-US">'github.com'</span></span><code><span lang="EN-US"> (RSA) to the </span></code><span class="keyword"><span lang="EN-US">list</span></span><code><span lang="EN-US"> of known hosts.<o:p></o:p></span></code></pre>

<p>这个警告只会出现一次，后面的操作就不会有任何警告了。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你实在担心有人冒充<span lang="EN-US">GitHub</span>服务器，输入<code><span lang="EN-US">yes</span></code>前可以对照<span lang="EN-US"><a href="https://help.github.com/articles/what-are-github-s-ssh-key-fingerprints/" target="_blank">GitHub<span lang="EN-US"><span lang="EN-US">的RSA Key</span></span><span lang="EN-US"><span lang="EN-US">的指纹信息</span></span></a></span>是否与<span lang="EN-US">SSH</span>连接给出的一致。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>要关联一个远程库，使用命令<code><span lang="EN-US">git remote add origin
git@server-name:path/repo-name.git</span></code>；<span lang="EN-US"><o:p></o:p></span></p>

<p>关联后，使用命令<code><span lang="EN-US">git push -u origin master</span></code>第一次推送<span lang="EN-US">master</span>分支的所有内容；<span lang="EN-US"><o:p></o:p></span></p>

<p>此后，每次本地提交后，只要有必要，就可以使用命令<code><span lang="EN-US">git push origin master</span></code>推送最新修改；<span lang="EN-US"><o:p></o:p></span></p>

<p>分布式版本系统的最大好处之一是在本地工作完全不需要考虑远程库的存在，也就是有没有联网都可以正常工作，而<span lang="EN-US">SVN</span>在没有联网的时候是拒绝干活的！当有网络的时候，再把本地提交推送一下就完成了同步，真是太方便了！<span lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<h3>从远程库克隆<span lang="EN-US"><o:p></o:p></span></h3>

<p>上次我们讲了先有本地库，后有远程库的时候，如何关联远程库。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，假设我们从零开发，那么最好的方式是先创建远程库，然后，从远程库克隆。<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，登陆<span lang="EN-US">GitHub</span>，创建一个新的仓库，名字叫<code><span lang="EN-US">gitskills</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_20"
 o:spid="_x0000_i1040" type="#_x0000_t75" alt="github-init-repo" style='width:343.5pt;
 height:269.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image019.png"
  o:title="github-init-repo"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image019.png" alt="github-init-repo" v:shapes="图片_x0020_20" border="0" height="359" width="458"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>我们勾选<code><span lang="EN-US">Initialize this repository with a README</span></code>，这样<span lang="EN-US">GitHub</span>会自动为我们创建一个<code><span lang="EN-US">README.md</span></code>文件。创建完毕后，可以看到<code><span lang="EN-US">README.md</span></code>文件：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_19"
 o:spid="_x0000_i1039" type="#_x0000_t75" alt="github-init-repo-2" style='width:381.75pt;
 height:247.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image020.png"
  o:title="github-init-repo-2"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image020.png" alt="github-init-repo-2" v:shapes="图片_x0020_19" border="0" height="330" width="509"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>现在，远程库已经准备好了，下一步是用命令<code><span lang="EN-US">git clone</span></code>克隆一个本地库：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git clone git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/gitskills.git<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Cloning</span></span><code><span lang="EN-US"> into </span></code><span class="string"><span lang="EN-US">'gitskills'</span></span><code><span lang="EN-US">...<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">remote:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Counting</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">objects:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US">, done.<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">remote:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Total</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">), reused </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Receiving</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">objects:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US">), done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">cd gitskills<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">ls<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">README</span></span><code><span lang="EN-US">.md<o:p></o:p></span></code></pre>

<p>注意把<span lang="EN-US">Git</span>库的地址换成你自己的，然后进入<code><span lang="EN-US">gitskills</span></code>目录看看，已经有<code><span lang="EN-US">README.md</span></code>文件了。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果有多个人协作开发，那么每个人各自从远程克隆一份就可以了。<span lang="EN-US"><o:p></o:p></span></p>

<p>你也许还注意到，<span lang="EN-US">GitHub</span>给出的地址不止一个，还可以用<code><span lang="EN-US">https://github.com/michaelliao/gitskills.git</span></code>这样的地址。实际上，<span lang="EN-US">Git</span>支持多种协议，默认的<code><span lang="EN-US">git://</span></code>使用<span lang="EN-US">ssh</span>，但也可以使用<code><span lang="EN-US">https</span></code>等其他协议。<span lang="EN-US"><o:p></o:p></span></p>

<p>使用<code><span lang="EN-US">https</span></code>除了速度慢以外，还有个最大的麻烦是每次推送都必须输入口令，但是在某些只开放<span lang="EN-US">http</span>端口的公司内部就无法使用<code><span lang="EN-US">ssh</span></code>协议而只能用<code><span lang="EN-US">https</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>要克隆一个仓库，首先必须知道仓库的地址，然后使用<code><span lang="EN-US">git clone</span></code>命令克隆。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>支持多种协议，包括<code><span lang="EN-US">https</span></code>，但通过<code><span lang="EN-US">ssh</span></code>支持的原生<code><span lang="EN-US">git</span></code>协议速度最快。<span lang="EN-US"><o:p></o:p></span></p>

<h3>更新远程库克隆<span lang="EN-US"><o:p></o:p></span></h3>

<h3>更新远程库出错：<span lang="EN-US"><o:p></o:p></span></h3>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">To
git@github.com:hpccn/hpccn.github.com.git<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US"><span style="">&nbsp;</span>! [rejected]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>master -&gt; master (non-fast-forward)<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">error:
failed to push some refs to 'git@github.com:hpccn/hpccn.github.com.git'<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">hint:
Updates were rejected because the tip of your current branch is behind<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">hint:
its remote counterpart. Integrate the remote changes (e.g.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">hint:
'git pull ...') before pushing again.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 9pt; font-family: &quot;Lucida Console&quot;;" lang="EN-US">hint:
See the 'Note about fast-forwards' in 'git push --help' for details.<o:p></o:p></span></p>

<p><span style="font-size: 10.5pt; color: rgb(51, 51, 51);">强制更新</span><span style="font-size: 10.5pt; font-family: &quot;Verdana&quot;,sans-serif; color: rgb(51, 51, 51);" lang="EN-US"><o:p></o:p></span></p>

<p><span style="font-size: 10.5pt; font-family: &quot;Verdana&quot;,sans-serif; color: rgb(51, 51, 51);" lang="EN-US">git push -u origin master -f&nbsp;</span><span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">分支管理</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>分支就是科幻电影里面的平行宇宙，当你正在电脑前努力学习<span lang="EN-US">Git</span>的时候，另一个你正在另一个平行宇宙里努力学习<span lang="EN-US">SVN</span>。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，你既学会了<span lang="EN-US">Git</span>又学会了<span lang="EN-US">SVN</span>！<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_21"
 o:spid="_x0000_i1038" type="#_x0000_t75" alt="learn-branches" style='width:381.75pt;
 height:130.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image021.png"
  o:title="learn-branches"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image021.png" alt="learn-branches" v:shapes="图片_x0020_21" border="0" height="174" width="509"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>分支在实际中有什么用呢？假设你准备开发一个新功能，但是需要两周才能完成，第一周你写了<span lang="EN-US">50%</span>的代码，如果立刻提交，由于代码还没写完，不完整的代码库会导致别人不能干活了。如果等代码全部写完再一次提交，又存在丢失每天进度的巨大风险。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在有了分支，就不用怕了。你创建了一个属于你自己的分支，别人看不到，还继续在原来的分支上正常工作，而你在自己的分支上干活，想提交就提交，直到开发完毕后，再一次性合并到原来的分支上，这样，既安全，又不影响别人工作。<span lang="EN-US"><o:p></o:p></span></p>

<p>其他版本控制系统如<span lang="EN-US">SVN</span>等都有分支管理，但是用过之后你会发现，这些版本控制系统创建和切换分支比蜗牛还慢，简直让人无法忍受，结果分支功能成了摆设，大家都不去用。<span lang="EN-US"><o:p></o:p></span></p>

<p>但<span lang="EN-US">Git</span>的分支是与众不同的，无论创建、切换和删除分支，<span lang="EN-US">Git</span>在<span lang="EN-US">1</span>秒钟之内就能完成！无论你的版本库是<span lang="EN-US">1</span>个文件还是<span lang="EN-US">1</span>万个文件。<span lang="EN-US"><o:p></o:p></span></p>

<h3>创建与合并分支<span lang="EN-US"><o:p></o:p></span></h3>

<p>在<span lang="EN-US"><a href="#_%E7%89%88%E6%9C%AC%E5%9B%9E%E9%80%80" target="_blank"><span lang="EN-US"><span lang="EN-US">版本回退</span></span></a></span>里，你已经知道，每次提交，<span lang="EN-US">Git</span>都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在<span lang="EN-US">Git</span>里，这个分支叫主分支，即<code><span lang="EN-US">master</span></code>分支。<code><span lang="EN-US">HEAD</span></code>严格来说不是指向提交，而是指向<code><span lang="EN-US">master</span></code>，<code><span lang="EN-US">master</span></code>才是指向提交的，所以，<code><span lang="EN-US">HEAD</span></code>指向的就是当前分支。<span lang="EN-US"><o:p></o:p></span></p>

<p>一开始的时候，<code><span lang="EN-US">master</span></code>分支是一条线，<span lang="EN-US">Git</span>用<code><span lang="EN-US">master</span></code>指向最新的提交，再用<code><span lang="EN-US">HEAD</span></code>指向<code><span lang="EN-US">master</span></code>，就能确定当前分支，以及当前分支的提交点：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_27"
 o:spid="_x0000_i1037" type="#_x0000_t75" alt="git-br-initial" style='width:225.75pt;
 height:113.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image022.png"
  o:title="git-br-initial"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image022.png" alt="git-br-initial" v:shapes="图片_x0020_27" border="0" height="151" width="301"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>每次提交，<code><span lang="EN-US">master</span></code>分支都会向前移动一步，这样，随着你不断提交，<code><span lang="EN-US">master</span></code>分支的线也越来越长：<span lang="EN-US"><o:p></o:p></span></p>

<p>当我们创建新的分支，例如<code><span lang="EN-US">dev</span></code>时，<span lang="EN-US">Git</span>新建了一个指针叫<code><span lang="EN-US">dev</span></code>，指向<code><span lang="EN-US">master</span></code>相同的提交，再把<code><span lang="EN-US">HEAD</span></code>指向<code><span lang="EN-US">dev</span></code>，就表示当前分支在<code><span lang="EN-US">dev</span></code>上：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_26"
 o:spid="_x0000_i1036" type="#_x0000_t75" alt="git-br-create" style='width:275.25pt;
 height:174.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image023.png"
  o:title="git-br-create"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image023.png" alt="git-br-create" v:shapes="图片_x0020_26" border="0" height="233" width="367"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>你看，<span lang="EN-US">Git</span>创建一个分支很快，因为除了增加一个<code><span lang="EN-US">dev</span></code>指针，改改<code><span lang="EN-US">HEAD</span></code>的指向，工作区的文件都没有任何变化！<span lang="EN-US"><o:p></o:p></span></p>

<p>不过，从现在开始，对工作区的修改和提交就是针对<code><span lang="EN-US">dev</span></code>分支了，比如新提交一次后，<code><span lang="EN-US">dev</span></code>指针往前移动一步，而<code><span lang="EN-US">master</span></code>指针不变：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_25"
 o:spid="_x0000_i1035" type="#_x0000_t75" alt="git-br-dev-fd" style='width:370.5pt;
 height:174.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image024.png"
  o:title="git-br-dev-fd"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image024.png" alt="git-br-dev-fd" v:shapes="图片_x0020_25" border="0" height="233" width="494"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>假如我们在<code><span lang="EN-US">dev</span></code>上的工作完成了，就可以把<code><span lang="EN-US">dev</span></code>合并到<code><span lang="EN-US">master</span></code>上。<span lang="EN-US">Git</span>怎么合并呢？最简单的方法，就是直接把<code><span lang="EN-US">master</span></code>指向<code><span lang="EN-US">dev</span></code>的当前提交，就完成了合并：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_24"
 o:spid="_x0000_i1034" type="#_x0000_t75" alt="git-br-ff-merge" style='width:317.25pt;
 height:166.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image025.png"
  o:title="git-br-ff-merge"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image025.png" alt="git-br-ff-merge" v:shapes="图片_x0020_24" border="0" height="222" width="423"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>所以<span lang="EN-US">Git</span>合并分支也很快！就改改指针，工作区内容也不变！<span lang="EN-US"><o:p></o:p></span></p>

<p>合并完分支后，甚至可以删除<code><span lang="EN-US">dev</span></code>分支。删除<code><span lang="EN-US">dev</span></code>分支就是把<code><span lang="EN-US">dev</span></code>指针给删掉，删掉后，我们就剩下了一条<code><span lang="EN-US">master</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_23"
 o:spid="_x0000_i1033" type="#_x0000_t75" alt="git-br-rm" style='width:317.25pt;
 height:119.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image026.png"
  o:title="git-br-rm"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image026.png" alt="git-br-rm" v:shapes="图片_x0020_23" border="0" height="159" width="423"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>真是太神奇了，你看得出来有些提交是通过分支完成的吗？<span lang="EN-US"><o:p></o:p></span></p>

<p>下面开始实战。<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，我们创建<code><span lang="EN-US">dev</span></code>分支，然后切换到<code><span lang="EN-US">dev</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to a new branch </span></code><span class="string"><span lang="EN-US">'dev'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git checkout</span></code>命令加上<code><span lang="EN-US">-b</span></code>参数表示创建并切换，相当于以下两条命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch dev<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'dev'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>然后，用<code><span lang="EN-US">git branch</span></code>命令查看当前分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* dev<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp; </span>master<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git branch</span></code>命令会列出所有分支，当前分支前面会标一个<code><span lang="EN-US">*</span></code>号。<span lang="EN-US"><o:p></o:p></span></p>

<p>然后，我们就可以在<code><span lang="EN-US">dev</span></code>分支上正常提交，比如对<span lang="EN-US">readme.txt</span>做个修改，加上一行：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Creating a </span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> branch is quick.<o:p></o:p></span></code></pre>

<p>然后提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt <o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"branch test"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[dev fec145a] branch test<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+)<o:p></o:p></span></code></pre>

<p>现在，<code><span lang="EN-US">dev</span></code>分支的工作完成，我们就可以切换回<code><span lang="EN-US">master</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout master<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'master'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>切换回<code><span lang="EN-US">master</span></code>分支后，再查看一个<span lang="EN-US">readme.txt</span>文件，刚才添加的内容不见了！因为那个提交是在<code><span lang="EN-US">dev</span></code>分支上，而<code><span lang="EN-US">master</span></code>分支此刻的提交点并没有变：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_22"
 o:spid="_x0000_i1032" type="#_x0000_t75" alt="git-br-on-master" style='width:314.25pt;
 height:166.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image027.png"
  o:title="git-br-on-master"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image027.png" alt="git-br-on-master" v:shapes="图片_x0020_22" border="0" height="222" width="419"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>现在，我们把<code><span lang="EN-US">dev</span></code>分支的工作成果合并到<code><span lang="EN-US">master</span></code>分支上：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git merge dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Updating</span></span><code><span lang="EN-US"> d17efd8..fec145a<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Fast</span></span><code><span lang="EN-US">-forward<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> readme.txt |<span style="">&nbsp;&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> +<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+)<o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">git merge</span></code>命令用于合并指定分支到当前分支。合并后，再查看<span lang="EN-US">readme.txt</span>的内容，就可以看到，和<code><span lang="EN-US">dev</span></code>分支的最新提交是完全一样的。<span lang="EN-US"><o:p></o:p></span></p>

<p>注意到上面的<code><span lang="EN-US">Fast-forward</span></code>信息，<span lang="EN-US">Git</span>告诉我们，这次合并是<span lang="EN-US">&ldquo;</span>快进模式<span lang="EN-US">&rdquo;</span>，也就是直接把<code><span lang="EN-US">master</span></code>指向<code><span lang="EN-US">dev</span></code>的当前提交，所以合并速度非常快。<span lang="EN-US"><o:p></o:p></span></p>

<p>当然，也不是每次合并都能<code><span lang="EN-US">Fast-forward</span></code>，我们后面会讲其他方式的合并。<span lang="EN-US"><o:p></o:p></span></p>

<p>合并完成后，就可以放心地删除<code><span lang="EN-US">dev</span></code>分支了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch -d dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> branch dev (was fec145a).<o:p></o:p></span></code></pre>

<p>删除后，查看<code><span lang="EN-US">branch</span></code>，就只剩下<code><span lang="EN-US">master</span></code>分支了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* master<o:p></o:p></span></code></pre>

<p>因为创建、合并和删除分支非常快，所以<span lang="EN-US">Git</span>鼓励你使用分支完成某个任务，合并后再删掉分支，这和直接在<code><span lang="EN-US">master</span></code>分支上工作效果是一样的，但过程更安全。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p><span lang="EN-US">Git</span>鼓励大量使用分支：<span lang="EN-US"><o:p></o:p></span></p>

<p>查看分支：<code><span lang="EN-US">git branch</span></code><span lang="EN-US"><o:p></o:p></span></p>

<p>创建分支：<code><span lang="EN-US">git branch &lt;name&gt;</span></code><span lang="EN-US"><o:p></o:p></span></p>

<p>切换分支：<code><span lang="EN-US">git checkout &lt;name&gt;</span></code><span lang="EN-US"><o:p></o:p></span></p>

<p>创建<span lang="EN-US">+</span>切换分支：<code><span lang="EN-US">git checkout -b
&lt;name&gt;</span></code><span lang="EN-US"><o:p></o:p></span></p>

<p>合并某分支到当前分支：<code><span lang="EN-US">git merge &lt;name&gt;</span></code><span lang="EN-US"><o:p></o:p></span></p>

<p>删除分支：<code><span lang="EN-US">git branch -d &lt;name&gt;</span></code><span lang="EN-US"><o:p></o:p></span></p>

<h3>解决冲突<span lang="EN-US"><o:p></o:p></span></h3>

<p>人生不如意之事十之八九，合并分支往往也不是一帆风顺的。<span lang="EN-US"><o:p></o:p></span></p>

<p>准备新的<code><span lang="EN-US">feature1</span></code>分支，继续我们的新分支开发：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b feature1<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to a new branch </span></code><span class="string"><span lang="EN-US">'feature1'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>修改<span lang="EN-US">readme.txt</span>最后一行，改为：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Creating a </span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> branch is quick </span></code><span class="keyword"><span lang="EN-US">AND</span></span><code><span lang="EN-US"> simple.<o:p></o:p></span></code></pre>

<p>在<code><span lang="EN-US">feature1</span></code>分支上提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git add readme.txt <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"AND simple"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[feature1 </span></span><span class="number"><span lang="EN-US">75</span></span><span class="operator"><span lang="EN-US">a857c] </span></span><span class="keyword"><span lang="EN-US">AND</span></span><span class="operator"><span lang="EN-US"> simple<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+), </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> deletion(-)<o:p></o:p></span></span></pre>

<p>切换到<code><span lang="EN-US">master</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git checkout master<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Switched to branch 'master'<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Your branch is ahead of 'origin/master' by 1 </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US">.<o:p></o:p></span></span></pre>

<p><span lang="EN-US">Git</span>还会自动提示我们当前<code><span lang="EN-US">master</span></code>分支比远程的<code><span lang="EN-US">master</span></code>分支要超前<span lang="EN-US">1</span>个提交。<span lang="EN-US"><o:p></o:p></span></p>

<p>在<code><span lang="EN-US">master</span></code>分支上把<span lang="EN-US">readme.txt</span>文件的最后一行改为：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Creating a </span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> branch is quick &amp; simple.<o:p></o:p></span></code></pre>

<p>提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt <o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"&amp; simple"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[master </span></code><span class="number"><span lang="EN-US">400</span></span><code><span lang="EN-US">b40</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">] &amp; simple<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+), </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> deletion(-)<o:p></o:p></span></code></pre>

<p>现在，<code><span lang="EN-US">master</span></code>分支和<code><span lang="EN-US">feature1</span></code>分支各自都分别有新的提交，变成了这样：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_29"
 o:spid="_x0000_i1031" type="#_x0000_t75" alt="git-br-feature1" style='width:318.75pt;
 height:204pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image028.png"
  o:title="git-br-feature1"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image028.png" alt="git-br-feature1" v:shapes="图片_x0020_29" border="0" height="272" width="425"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>这种情况下，<span lang="EN-US">Git</span>无法执行<span lang="EN-US">&ldquo;</span>快速合并<span lang="EN-US">&rdquo;</span>，只能试图把各自的修改合并起来，但这种合并就可能会有冲突，我们试试看：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git merge feature1<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Auto</span></span><code><span lang="EN-US">-merging readme.txt<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">CONFLICT</span></span><code><span lang="EN-US"> (content)</span></code><span class="symbol"><span lang="EN-US">:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Merge</span></span><code><span lang="EN-US"> conflict </span></code><span class="keyword"><span lang="EN-US">in</span></span><code><span lang="EN-US"> readme.txt<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Automatic</span></span><code><span lang="EN-US"> merge failed; fix conflicts </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">then</span></span><code><span lang="EN-US"> commit the result.<o:p></o:p></span></code></pre>

<p>果然冲突了！<span lang="EN-US">Git</span>告诉我们，<span lang="EN-US">readme.txt</span>文件存在冲突，必须手动解决冲突后再提交。<code><span lang="EN-US">git status</span></code>也可以告诉我们冲突的文件：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch master</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Your branch is ahead of 'origin/master' by 2 commits.</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Unmerged paths:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add/rm &lt;file&gt;..." as appropriate to mark resolution)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>both modified:<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">no changes added to commit (use </span></code><span class="string"><span lang="EN-US">"git add"</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US">/</span></code><span class="keyword"><span lang="EN-US">or</span></span><code><span lang="EN-US"> </span></code><span class="string"><span lang="EN-US">"git commit -a"</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>我们可以直接查看<span lang="EN-US">readme.txt</span>的内容：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Git is a distributed version control system.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git is free software distributed under the GPL.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git has a mutable index called stage.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Git tracks changes of files.<o:p></o:p></span></code></pre><pre><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">&lt;&lt;&lt;&lt;&lt;&lt;</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">HEAD</span></span><span class="tag"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="attribute"><span lang="EN-US">Creating</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">a</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">new</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">branch</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">is</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">quick</span></span><span class="tag"><span lang="EN-US"> &amp; </span></span><span class="attribute"><span lang="EN-US">simple.</span></span><span class="tag"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="tag"><span lang="EN-US">=</span></span><span class="value"><span lang="EN-US">======</span></span><span class="tag"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="attribute"><span lang="EN-US">Creating</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">a</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">new</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">branch</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">is</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">quick</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">AND</span></span><span class="tag"><span lang="EN-US"> </span></span><span class="attribute"><span lang="EN-US">simple.</span></span><span class="tag"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="tag"><span lang="EN-US">&gt;</span></span><span class="xml"><span lang="EN-US">&gt;&gt;&gt;&gt;&gt;&gt; feature1<o:p></o:p></span></span></pre>

<p><span lang="EN-US">Git</span>用<code><span lang="EN-US">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></code>，<code><span lang="EN-US">=======</span></code>，<code><span lang="EN-US">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></code>标记出不同分支的内容，我们修改如下后保存：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">Creating a </span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> branch is quick </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US"> simple.<o:p></o:p></span></code></pre>

<p>再提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt <o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"conflict fixed"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[master </span></code><span class="number"><span lang="EN-US">59</span></span><code><span lang="EN-US">bc1cb] conflict fixed<o:p></o:p></span></code></pre>

<p>现在，<code><span lang="EN-US">master</span></code>分支和<code><span lang="EN-US">feature1</span></code>分支变成了下图所示：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_28"
 o:spid="_x0000_i1030" type="#_x0000_t75" alt="git-br-conflict-merged" style='width:413.25pt;
 height:204pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image029.png"
  o:title="git-br-conflict-merged"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image029.png" alt="git-br-conflict-merged" v:shapes="图片_x0020_28" border="0" height="272" width="551"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>用带参数的<code><span lang="EN-US">git log</span></code>也可以看到分支的合并情况：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git log --graph --pretty=oneline --abbrev-commit<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*<span style="">&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">59</span></span><code><span lang="EN-US">bc1cb conflict fixed<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">|\<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">| * </span></code><span class="number"><span lang="EN-US">75</span></span><code><span lang="EN-US">a857c </span></code><span class="keyword"><span lang="EN-US">AND</span></span><code><span lang="EN-US"> simple<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* | </span></code><span class="number"><span lang="EN-US">400</span></span><code><span lang="EN-US">b400 &amp; simple<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">|/<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* fec145a branch test<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">...<o:p></o:p></span></code></pre>

<p>最后，删除<code><span lang="EN-US">feature1</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch -d feature1<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> branch feature1 (was </span></code><span class="number"><span lang="EN-US">75</span></span><code><span lang="EN-US">a857c).<o:p></o:p></span></code></pre>

<p>工作完成。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>当<span lang="EN-US">Git</span>无法自动合并分支时，就必须首先解决冲突。解决冲突后，再提交，合并完成。<span lang="EN-US"><o:p></o:p></span></p>

<p>用<code><span lang="EN-US">git log --graph</span></code>命令可以看到分支合并图。<span lang="EN-US"><o:p></o:p></span></p>

<h3>分支管理策略<span lang="EN-US"><o:p></o:p></span></h3>

<p>通常，合并分支时，如果可能，<span lang="EN-US">Git</span>会用<code><span lang="EN-US">Fast
forward</span></code>模式，但这种模式下，删除分支后，会丢掉分支信息。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果要强制禁用<code><span lang="EN-US">Fast forward</span></code>模式，<span lang="EN-US">Git</span>就会在<span lang="EN-US">merge</span>时生成一个新的<span lang="EN-US">commit</span>，这样，从分支历史上就可以看出分支信息。<span lang="EN-US"><o:p></o:p></span></p>

<p>下面我们实战一下<code><span lang="EN-US">--no-ff</span></code>方式的<code><span lang="EN-US">git merge</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，仍然创建并切换<code><span lang="EN-US">dev</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to a new branch </span></code><span class="string"><span lang="EN-US">'dev'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>修改<span lang="EN-US">readme.txt</span>文件，并提交一个新的<span lang="EN-US">commit</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git add readme.txt <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"add merge"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[dev </span></span><span class="number"><span lang="EN-US">6224937</span></span><span class="operator"><span lang="EN-US">] </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> merge<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+)<o:p></o:p></span></span></pre>

<p>现在，我们切换回<code><span lang="EN-US">master</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout master<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'master'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>准备合并<code><span lang="EN-US">dev</span></code>分支，请注意<code><span lang="EN-US">--no-ff</span></code>参数，表示禁用<code><span lang="EN-US">Fast forward</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git merge --no-ff -m </span></code><span class="string"><span lang="EN-US">"merge with no-ff"</span></span><code><span lang="EN-US"> dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Merge</span></span><code><span lang="EN-US"> made by the </span></code><span class="string"><span lang="EN-US">'recursive'</span></span><code><span lang="EN-US"> strategy.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> readme.txt |<span style="">&nbsp;&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> +<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+)<o:p></o:p></span></code></pre>

<p>因为本次合并要创建一个新的<span lang="EN-US">commit</span>，所以加上<code><span lang="EN-US">-m</span></code>参数，把<span lang="EN-US">commit</span>描述写进去。<span lang="EN-US"><o:p></o:p></span></p>

<p>合并后，我们用<code><span lang="EN-US">git log</span></code>看看分支历史：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git log --graph --pretty=oneline --abbrev-commit<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*<span style="">&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">7825</span></span><code><span lang="EN-US">a50 merge </span></code><span class="keyword"><span lang="EN-US">with</span></span><code><span lang="EN-US"> no-ff<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">|\<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">| * </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"> add merge<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">|/<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*<span style="">&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">59</span></span><code><span lang="EN-US">bc1cb conflict fixed<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">...<o:p></o:p></span></code></pre>

<p>可以看到，不使用<code><span lang="EN-US">Fast forward</span></code>模式，<span lang="EN-US">merge</span>后就像这样：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_31"
 o:spid="_x0000_i1029" type="#_x0000_t75" alt="git-no-ff-mode" style='width:5in;
 height:192.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image030.png"
  o:title="git-no-ff-mode"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image030.png" alt="git-no-ff-mode" v:shapes="图片_x0020_31" border="0" height="257" width="480"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E5-88-86-E6-94-AF-E7-AD-96-E7-95-A5"></a><span style="font-family: 宋体;">分支策略</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>在实际开发中，我们应该按照几个基本原则进行分支管理：<span lang="EN-US"><o:p></o:p></span></p>

<p>首先，<code><span lang="EN-US">master</span></code>分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；<span lang="EN-US"><o:p></o:p></span></p>

<p>那在哪干活呢？干活都在<code><span lang="EN-US">dev</span></code>分支上，也就是说，<code><span lang="EN-US">dev</span></code>分支是不稳定的，到某个时候，比如<span lang="EN-US">1.0</span>版本发布时，再把<code><span lang="EN-US">dev</span></code>分支合并到<code><span lang="EN-US">master</span></code>上，在<code><span lang="EN-US">master</span></code>分支发布<span lang="EN-US">1.0</span>版本；<span lang="EN-US"><o:p></o:p></span></p>

<p>你和你的小伙伴们每个人都在<code><span lang="EN-US">dev</span></code>分支上干活，每个人都有自己的分支，时不时地往<code><span lang="EN-US">dev</span></code>分支上合并就可以了。<span lang="EN-US"><o:p></o:p></span></p>

<p>所以，团队合作的分支看起来就像这样：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_30"
 o:spid="_x0000_i1028" type="#_x0000_t75" alt="git-br-policy" style='width:373.5pt;
 height:93.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image031.png"
  o:title="git-br-policy"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image031.png" alt="git-br-policy" v:shapes="图片_x0020_30" border="0" height="125" width="498"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p><span lang="EN-US">Git</span>分支十分强大，在团队开发中应该充分应用。<span lang="EN-US"><o:p></o:p></span></p>

<p>合并分支时，加上<code><span lang="EN-US">--no-ff</span></code>参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而<code><span lang="EN-US">fast forward</span></code>合并就看不出来曾经做过合并。<span lang="EN-US"><o:p></o:p></span></p>

<h3><span lang="EN-US">Bug</span>分支<span lang="EN-US"><o:p></o:p></span></h3>

<p>软件开发中，<span lang="EN-US">bug</span>就像家常便饭一样。有了<span lang="EN-US">bug</span>就需要修复，在<span lang="EN-US">Git</span>中，由于分支是如此的强大，所以，每个<span lang="EN-US">bug</span>都可以通过一个新的临时分支来修复，修复后，合并分支，然后将临时分支删除。<span lang="EN-US"><o:p></o:p></span></p>

<p>当你接到一个修复一个代号<span lang="EN-US">101</span>的<span lang="EN-US">bug</span>的任务时，很自然地，你想创建一个分支<code><span lang="EN-US">issue-101</span></code>来修复它，但是，等等，当前正在<code><span lang="EN-US">dev</span></code>上进行的工作还没有提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch dev</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>new file:<span style="">&nbsp;&nbsp; </span>hello.py</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>并不是你不想提交，而是工作只进行到一半，还没法提交，预计完成还需<span lang="EN-US">1</span>天时间。但是，必须在两个小时内修复该<span lang="EN-US">bug</span>，怎么办？<span lang="EN-US"><o:p></o:p></span></p>

<p>幸好，<span lang="EN-US">Git</span>还提供了一个<code><span lang="EN-US">stash</span></code>功能，可以把当前工作现场<span lang="EN-US">&ldquo;</span>储藏<span lang="EN-US">&rdquo;</span>起来，等以后恢复现场后继续工作：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git stash<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Saved</span></span><code><span lang="EN-US"> working directory </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US"> index state </span></code><span class="constant"><span lang="EN-US">WIP</span></span><code><span lang="EN-US"> on </span></code><span class="symbol"><span lang="EN-US">dev:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"> add merge<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">HEAD</span></span><code><span lang="EN-US"> is now at </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"> add merge<o:p></o:p></span></code></pre>

<p>现在，用<code><span lang="EN-US">git status</span></code>查看工作区，就是干净的（除非有没有被<span lang="EN-US">Git</span>管理的文件），因此可以放心地创建分支来修复<span lang="EN-US">bug</span>。<span lang="EN-US"><o:p></o:p></span></p>

<p>首先确定要在哪个分支上修复<span lang="EN-US">bug</span>，假定需要在<code><span lang="EN-US">master</span></code>分支上修复，就从<code><span lang="EN-US">master</span></code>创建临时分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout master<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'master'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Your</span></span><code><span lang="EN-US"> branch is ahead of </span></code><span class="string"><span lang="EN-US">'origin/master'</span></span><code><span lang="EN-US"> by </span></code><span class="number"><span lang="EN-US">6</span></span><code><span lang="EN-US"> commits.<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b issue-</span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to a new branch </span></code><span class="string"><span lang="EN-US">'issue-101'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>现在修复<span lang="EN-US">bug</span>，需要把<span lang="EN-US">&ldquo;Git is free software
...&rdquo;</span>改为<span lang="EN-US">&ldquo;Git is a free software ...&rdquo;</span>，然后提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add readme.txt <o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"fix bug 101"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[issue-</span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"> cc17032] fix bug </span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+), </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> deletion(-)<o:p></o:p></span></code></pre>

<p>修复完成后，切换到<code><span lang="EN-US">master</span></code>分支，并完成合并，最后删除<code><span lang="EN-US">issue-101</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout master<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'master'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Your</span></span><code><span lang="EN-US"> branch is ahead of </span></code><span class="string"><span lang="EN-US">'origin/master'</span></span><code><span lang="EN-US"> by </span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US"> commits.<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git merge --no-ff -m </span></code><span class="string"><span lang="EN-US">"merged bug fix 101"</span></span><code><span lang="EN-US"> issue-</span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Merge</span></span><code><span lang="EN-US"> made by the </span></code><span class="string"><span lang="EN-US">'recursive'</span></span><code><span lang="EN-US"> strategy.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> readme.txt |<span style="">&nbsp;&nbsp;&nbsp; </span></span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US"> +-<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> insertion(+), </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> deletion(-)<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch -d issue-</span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> branch issue-</span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"> (was cc17032).<o:p></o:p></span></code></pre>

<p>太棒了，原计划两个小时的<span lang="EN-US">bug</span>修复只花了<span lang="EN-US">5</span>分钟！现在，是时候接着回到<code><span lang="EN-US">dev</span></code>分支干活了！<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout dev<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'dev'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch dev</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">nothing to commit (working directory clean)<o:p></o:p></span></code></pre>

<p>工作区是干净的，刚才的工作现场存到哪去了？用<code><span lang="EN-US">git stash list</span></code>命令看看：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git stash list<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">stash@{</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">}</span></code><span class="symbol"><span lang="EN-US">:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">WIP</span></span><code><span lang="EN-US"> on </span></code><span class="symbol"><span lang="EN-US">dev:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"> add merge<o:p></o:p></span></code></pre>

<p>工作现场还在，<span lang="EN-US">Git</span>把<span lang="EN-US">stash</span>内容存在某个地方了，但是需要恢复一下，有两个办法：<span lang="EN-US"><o:p></o:p></span></p>

<p>一是用<code><span lang="EN-US">git stash apply</span></code>恢复，但是恢复后，<span lang="EN-US">stash</span>内容并不删除，你需要用<code><span lang="EN-US">git stash drop</span></code>来删除；<span lang="EN-US"><o:p></o:p></span></p>

<p>另一种方式是用<code><span lang="EN-US">git stash pop</span></code>，恢复的同时把<span lang="EN-US">stash</span>内容也删了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git stash pop<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch dev</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>new file:<span style="">&nbsp;&nbsp; </span>hello.py</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes not staged for commit:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git add &lt;file&gt;..." to update what will be committed)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>modified:<span style="">&nbsp;&nbsp; </span>readme.txt</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Dropped</span></span><code><span lang="EN-US"> refs/stash@{</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">} (f624f8e5f082f2df2bed8a4e09c12fd2943bdd4</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>再用<code><span lang="EN-US">git stash list</span></code>查看，就看不到任何<span lang="EN-US">stash</span>内容了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git stash list<o:p></o:p></span></code></pre>

<p>你可以多次<span lang="EN-US">stash</span>，恢复的时候，先用<code><span lang="EN-US">git stash
list</span></code>查看，然后恢复指定的<span lang="EN-US">stash</span>，用命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git stash apply stash@{</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">}<o:p></o:p></span></code></pre>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>修复<span lang="EN-US">bug</span>时，我们会通过创建新的<span lang="EN-US">bug</span>分支进行修复，然后合并，最后删除；<span lang="EN-US"><o:p></o:p></span></p>

<p>当手头工作没有完成时，先把工作现场<code><span lang="EN-US">git stash</span></code>一下，然后去修复<span lang="EN-US">bug</span>，修复后，再<code><span lang="EN-US">git stash pop</span></code>，回到工作现场。<span lang="EN-US"><o:p></o:p></span></p>

<h3><span lang="EN-US">Feature</span>分支<span lang="EN-US"><o:p></o:p></span></h3>

<p>软件开发中，总有无穷无尽的新的功能要不断添加进来。<span lang="EN-US"><o:p></o:p></span></p>

<p>添加一个新功能时，你肯定不希望因为一些实验性质的代码，把主分支搞乱了，所以，每添加一个新功能，最好新建一个<span lang="EN-US">feature</span>分支，在上面开发，完成后，合并，最后，删除该<span lang="EN-US">feature</span>分支。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，你终于接到了一个新任务：开发代号为<span lang="EN-US">Vulcan</span>的新功能，该功能计划用于下一代星际飞船。<span lang="EN-US"><o:p></o:p></span></p>

<p>于是准备开发：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b feature-vulcan<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to a new branch </span></code><span class="string"><span lang="EN-US">'feature-vulcan'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><span lang="EN-US">5</span>分钟后，开发完毕：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add vulcan.py<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git status<o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># On branch feature-vulcan</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Changes to be committed:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp; </span>(use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>new file:<span style="">&nbsp;&nbsp; </span>vulcan.py</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="comment"><span lang="EN-US">#</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git commit -m </span></code><span class="string"><span lang="EN-US">"add feature vulcan"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[feature-vulcan </span></code><span class="number"><span lang="EN-US">756</span></span><code><span lang="EN-US">d4af] add feature vulcan<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> file changed, </span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US"> insertions(+)<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> create mode </span></code><span class="number"><span lang="EN-US">100644</span></span><code><span lang="EN-US"> vulcan.py<o:p></o:p></span></code></pre>

<p>切回<code><span lang="EN-US">dev</span></code>，准备合并：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout dev<o:p></o:p></span></code></pre>

<p>一切顺利的话，<span lang="EN-US">feature</span>分支和<span lang="EN-US">bug</span>分支是类似的，合并，然后删除。<span lang="EN-US"><o:p></o:p></span></p>

<p>但是，<span lang="EN-US"><o:p></o:p></span></p>

<p>就在此时，接到上级命令，因经费不足，新功能必须取消！<span lang="EN-US"><o:p></o:p></span></p>

<p>虽然白干了，但是这个分支还是必须就地销毁：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch -d feature-vulcan<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">error:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">The</span></span><code><span lang="EN-US"> branch </span></code><span class="string"><span lang="EN-US">'feature-vulcan'</span></span><code><span lang="EN-US"> is </span></code><span class="keyword"><span lang="EN-US">not</span></span><code><span lang="EN-US"> fully merged.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">If</span></span><code><span lang="EN-US"> you are sure you want to delete it, run </span></code><span class="string"><span lang="EN-US">'git branch -D feature-vulcan'</span></span><code><span lang="EN-US">.<o:p></o:p></span></code></pre>

<p>销毁失败。<span lang="EN-US">Git</span>友情提醒，<code><span lang="EN-US">feature-vulcan</span></code>分支还没有被合并，如果删除，将丢失掉修改，如果要强行删除，需要使用命令<code><span lang="EN-US">git branch -D feature-vulcan</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在我们强行删除：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch -</span></code><span class="constant"><span lang="EN-US">D</span></span><code><span lang="EN-US"> feature-vulcan<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> branch feature-vulcan (was </span></code><span class="number"><span lang="EN-US">756</span></span><code><span lang="EN-US">d4af).<o:p></o:p></span></code></pre>

<p>终于删除成功！<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>开发一个新<span lang="EN-US">feature</span>，最好新建一个分支；<span lang="EN-US"><o:p></o:p></span></p>

<p>如果要丢弃一个没有被合并过的分支，可以通过<code><span lang="EN-US">git branch -D &lt;name&gt;</span></code>强行删除。<span lang="EN-US"><o:p></o:p></span></p>

<h3>多人协作<span lang="EN-US"><o:p></o:p></span></h3>

<p>当你从远程仓库克隆时，实际上<span lang="EN-US">Git</span>自动把本地的<code><span lang="EN-US">master</span></code>分支和远程的<code><span lang="EN-US">master</span></code>分支对应起来了，并且，远程仓库的默认名称是<code><span lang="EN-US">origin</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>要查看远程库的信息，用<code><span lang="EN-US">git remote</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git remote<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">origin<o:p></o:p></span></code></pre>

<p>或者，用<code><span lang="EN-US">git remote -v</span></code>显示更详细的信息：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git remote -v<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">origin<span style="">&nbsp; </span>git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git (fetch)<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">origin<span style="">&nbsp; </span>git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git (push)<o:p></o:p></span></code></pre>

<p>上面显示了可以抓取和推送的<code><span lang="EN-US">origin</span></code>的地址。如果没有推送权限，就看不到<span lang="EN-US">push</span>的地址。<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E6-8E-A8-E9-80-81-E5-88-86-E6-94-AF"></a><span style="font-family: 宋体;">推送分支</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>推送分支，就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样，<span lang="EN-US">Git</span>就会把该分支推送到远程库对应的远程分支上：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git push origin master<o:p></o:p></span></code></pre>

<p>如果要推送其他分支，比如<code><span lang="EN-US">dev</span></code>，就改成：<span lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">$ git push origin dev<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">但是，并不是一定要把本地分支往远程推送，那么，哪些分支需要推送，哪些不需要呢？<span lang="EN-US"><o:p></o:p></span></span></p>

<ul type="disc"><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">master</span><span style="font-size: 12pt; font-family: 宋体;">分支是主分支，因此要时刻与远程同步；<span lang="EN-US"><o:p></o:p></span></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">dev</span><span style="font-size: 12pt; font-family: 宋体;">分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；<span lang="EN-US"><o:p></o:p></span></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">bug</span><span style="font-size: 12pt; font-family: 宋体;">分支只用于在本地修复<span lang="EN-US">bug</span>，就没必要推到远程了，除非老板要看看你每周到底修复了几个<span lang="EN-US">bug</span>；<span lang="EN-US"><o:p></o:p></span></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">feature</span><span style="font-size: 12pt; font-family: 宋体;">分支是否推到远程，取决于你是否和你的小伙伴合作在上面开发。<span lang="EN-US"><o:p></o:p></span></span></li></ul>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">总之，就是在<span lang="EN-US">Git</span>中，分支完全可以在本地自己藏着玩，是否推送，视你的心情而定！<span lang="EN-US"><o:p></o:p></span></span></p>

<h4><span style="font-family: 宋体;">抓取分支</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>多人协作时，大家都会往<code><span lang="EN-US">master</span></code>和<code><span lang="EN-US">dev</span></code>分支上推送各自的修改。<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，模拟一个你的小伙伴，可以在另一台电脑（注意要把<span lang="EN-US">SSH Key</span>添加到<span lang="EN-US">GitHub</span>）或者同一台电脑的另一个目录下克隆：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git clone git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Cloning</span></span><code><span lang="EN-US"> into </span></code><span class="string"><span lang="EN-US">'learngit'</span></span><code><span lang="EN-US">...<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">remote:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Counting</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">objects:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">46</span></span><code><span lang="EN-US">, done.<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">remote:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Compressing</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">objects:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">26</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">26</span></span><code><span lang="EN-US">), done.<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">remote:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Total</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">46</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">16</span></span><code><span lang="EN-US">), reused </span></code><span class="number"><span lang="EN-US">45</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">15</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Receiving</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">objects:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">46</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">46</span></span><code><span lang="EN-US">), </span></code><span class="number"><span lang="EN-US">15.69</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">KiB</span></span><code><span lang="EN-US"> | </span></code><span class="number"><span lang="EN-US">6</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">KiB</span></span><code><span lang="EN-US">/s, done.<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Resolving</span></span><code><span lang="EN-US"> </span></code><span class="symbol"><span lang="EN-US">deltas:</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">16</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">16</span></span><code><span lang="EN-US">), done.<o:p></o:p></span></code></pre>

<p>当你的小伙伴从远程库<span lang="EN-US">clone</span>时，默认情况下，你的小伙伴只能看到本地的<code><span lang="EN-US">master</span></code>分支。不信可以用<code><span lang="EN-US">git branch</span></code>命令看看：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* master<o:p></o:p></span></code></pre>

<p>现在，你的小伙伴要在<code><span lang="EN-US">dev</span></code>分支上开发，就必须创建远程<code><span lang="EN-US">origin</span></code>的<code><span lang="EN-US">dev</span></code>分支到本地，于是他用这个命令创建本地<code><span lang="EN-US">dev</span></code>分支：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout -b dev origin/dev<o:p></o:p></span></code></pre>

<p>现在，他就可以在<code><span lang="EN-US">dev</span></code>上继续修改，然后，时不时地把<code><span lang="EN-US">dev</span></code>分支<code><span lang="EN-US">push</span></code>到远程：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"add /usr/bin/env"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[dev </span></span><span class="number"><span lang="EN-US">291</span></span><span class="operator"><span lang="EN-US">bea8] </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> /usr/bin/env<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">$ git push origin dev<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Counting objects: </span></span><span class="number"><span lang="EN-US">5</span></span><span class="operator"><span lang="EN-US">, done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Delta compression </span></span><span class="keyword"><span lang="EN-US">using</span></span><span class="operator"><span lang="EN-US"> up </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">4</span></span><span class="operator"><span lang="EN-US"> threads.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Compressing objects: </span></span><span class="number"><span lang="EN-US">100</span></span><span class="operator"><span lang="EN-US">% (</span></span><span class="number"><span lang="EN-US">2</span></span><span class="operator"><span lang="EN-US">/</span></span><span class="number"><span lang="EN-US">2</span></span><span class="operator"><span lang="EN-US">), done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Writing objects: </span></span><span class="number"><span lang="EN-US">100</span></span><span class="operator"><span lang="EN-US">% (</span></span><span class="number"><span lang="EN-US">3</span></span><span class="operator"><span lang="EN-US">/</span></span><span class="number"><span lang="EN-US">3</span></span><span class="operator"><span lang="EN-US">), </span></span><span class="number"><span lang="EN-US">349</span></span><span class="operator"><span lang="EN-US"> bytes, done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Total </span></span><span class="number"><span lang="EN-US">3</span></span><span class="operator"><span lang="EN-US"> (delta </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US">), reused </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US"> (delta </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US">)<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">To</span></span><span class="operator"><span lang="EN-US"> git@github.com:michaelliao/learngit.git<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><span style="">&nbsp;&nbsp; </span>fc38031.</span></span><span class="number"><span lang="EN-US">.291</span></span><span class="operator"><span lang="EN-US">bea8<span style="">&nbsp; </span>dev -&gt; dev<o:p></o:p></span></span></pre>

<p>你的小伙伴已经向<code><span lang="EN-US">origin/dev</span></code>分支推送了他的提交，而碰巧你也对同样的文件作了修改，并试图推送：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git add hello.py <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"add coding: utf-8"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[dev bd6ae48] </span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> coding: utf-</span></span><span class="number"><span lang="EN-US">8</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> file changed, </span></span><span class="number"><span lang="EN-US">1</span></span><span class="operator"><span lang="EN-US"> insertion(+)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">$ git push origin dev<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">To</span></span><span class="operator"><span lang="EN-US"> git@github.com:michaelliao/learngit.git<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"> ! [rejected]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dev -&gt; dev (non-fast-forward)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">error: failed </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> push </span></span><span class="keyword"><span lang="EN-US">some</span></span><span class="operator"><span lang="EN-US"> refs </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="string"><span lang="EN-US">'git@github.com:michaelliao/learngit.git'</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">hint: Updates were rejected because the tip </span></span><span class="keyword"><span lang="EN-US">of</span></span><span class="operator"><span lang="EN-US"> your </span></span><span class="keyword"><span lang="EN-US">current</span></span><span class="operator"><span lang="EN-US"> branch </span></span><span class="keyword"><span lang="EN-US">is</span></span><span class="operator"><span lang="EN-US"> behind<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">hint: its remote counterpart. Merge the remote changes (e.g. </span></span><span class="string"><span lang="EN-US">'git pull'</span></span><span class="operator"><span lang="EN-US">)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">hint: before pushing again.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">hint: See the </span></span><span class="string"><span lang="EN-US">'Note about fast-forwards'</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">in</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="string"><span lang="EN-US">'git push --help'</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="keyword"><span lang="EN-US">for</span></span><span class="operator"><span lang="EN-US"> details.<o:p></o:p></span></span></pre>

<p>推送失败，因为你的小伙伴的最新提交和你试图推送的提交有冲突，解决办法也很简单，<span lang="EN-US">Git</span>已经提示我们，先用<code><span lang="EN-US">git pull</span></code>把最新的提交从<code><span lang="EN-US">origin/dev</span></code>抓下来，然后，在本地合并，解决冲突，再推送：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git pull<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">remote: Counting objects: </span></code><span class="number"><span lang="EN-US">5</span></span><code><span lang="EN-US">, done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">remote: Compressing objects: </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US">), done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">remote: Total </span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">), reused </span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Unpacking objects: </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">3</span></span><code><span lang="EN-US">), done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">From github.com:michaelliao/learngit<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp; </span>fc38031.</span></code><span class="number"><span lang="EN-US">.291</span></span><code><span lang="EN-US">bea8<span style="">&nbsp; </span>dev<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-&gt; origin/dev<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">There is no tracking information </span></code><span class="keyword"><span lang="EN-US">for</span></span><code><span lang="EN-US"> the current branch.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Please specify which branch you want to merge </span></code><span class="keyword"><span lang="EN-US">with</span></span><code><span lang="EN-US">.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">See git-pull(</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US">) </span></code><span class="keyword"><span lang="EN-US">for</span></span><code><span lang="EN-US"> details<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>git pull &lt;remote&gt; </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">branch</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><span class="xml"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="xml"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="xml"><span lang="EN-US">If you wish to set tracking information for this branch you can do so with:<o:p></o:p></span></span></pre><pre><span class="xml"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="xml"><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>git branch --set-upstream dev origin/</span></span><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">branch</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><span class="xml"><span lang="EN-US"><o:p></o:p></span></span></pre>

<p><code><span lang="EN-US">git pull</span></code>也失败了，原因是没有指定本地<code><span lang="EN-US">dev</span></code>分支与远程<code><span lang="EN-US">origin/dev</span></code>分支的链接，根据提示，设置<code><span lang="EN-US">dev</span></code>和<code><span lang="EN-US">origin/dev</span></code>的链接：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git branch </span></code><span class="comment"><span lang="EN-US">--set-upstream dev origin/dev</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Branch dev </span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> up </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> track remote branch dev </span></span><span class="keyword"><span lang="EN-US">from</span></span><span class="operator"><span lang="EN-US"> origin.<o:p></o:p></span></span></pre>

<p>再<span lang="EN-US">pull</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git pull<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Auto</span></span><code><span lang="EN-US">-merging hello.py<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">CONFLICT</span></span><code><span lang="EN-US"> (content)</span></code><span class="symbol"><span lang="EN-US">:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Merge</span></span><code><span lang="EN-US"> conflict </span></code><span class="keyword"><span lang="EN-US">in</span></span><code><span lang="EN-US"> hello.py<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Automatic</span></span><code><span lang="EN-US"> merge failed; fix conflicts </span></code><span class="keyword"><span lang="EN-US">and</span></span><code><span lang="EN-US"> </span></code><span class="keyword"><span lang="EN-US">then</span></span><code><span lang="EN-US"> commit the result.<o:p></o:p></span></code></pre>

<p>这回<code><span lang="EN-US">git pull</span></code>成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的<span lang="EN-US"><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/001375840202368c74be33fbd884e71b570f2cc3c0d1dcf000" target="_blank"><span lang="EN-US"><span lang="EN-US">解决冲突</span></span></a></span>完全一样。解决后，提交，再<span lang="EN-US">push</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> -m </span></span><span class="string"><span lang="EN-US">"merge &amp; fix hello.py"</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">[dev adca45d] merge &amp; fix hello.py<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">$ git push origin dev<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Counting objects: </span></span><span class="number"><span lang="EN-US">10</span></span><span class="operator"><span lang="EN-US">, done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Delta compression </span></span><span class="keyword"><span lang="EN-US">using</span></span><span class="operator"><span lang="EN-US"> up </span></span><span class="keyword"><span lang="EN-US">to</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">4</span></span><span class="operator"><span lang="EN-US"> threads.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Compressing objects: </span></span><span class="number"><span lang="EN-US">100</span></span><span class="operator"><span lang="EN-US">% (</span></span><span class="number"><span lang="EN-US">5</span></span><span class="operator"><span lang="EN-US">/</span></span><span class="number"><span lang="EN-US">5</span></span><span class="operator"><span lang="EN-US">), done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Writing objects: </span></span><span class="number"><span lang="EN-US">100</span></span><span class="operator"><span lang="EN-US">% (</span></span><span class="number"><span lang="EN-US">6</span></span><span class="operator"><span lang="EN-US">/</span></span><span class="number"><span lang="EN-US">6</span></span><span class="operator"><span lang="EN-US">), </span></span><span class="number"><span lang="EN-US">747</span></span><span class="operator"><span lang="EN-US"> bytes, done.<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Total </span></span><span class="number"><span lang="EN-US">6</span></span><span class="operator"><span lang="EN-US"> (delta </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US">), reused </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US"> (delta </span></span><span class="number"><span lang="EN-US">0</span></span><span class="operator"><span lang="EN-US">)<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">To</span></span><span class="operator"><span lang="EN-US"> git@github.com:michaelliao/learngit.git<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><span style="">&nbsp;&nbsp; </span></span></span><span class="number"><span lang="EN-US">291</span></span><span class="operator"><span lang="EN-US">bea8..adca45d<span style="">&nbsp; </span>dev -&gt; dev<o:p></o:p></span></span></pre>

<p>因此，多人协作的工作模式通常是这样：<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span lang="EN-US"><span style="">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp; </span></span></span><!--[endif]-->首先，可以试图用<code><span lang="EN-US">git push origin branch-name</span></code>推送自己的修改；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span lang="EN-US"><span style="">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp; </span></span></span><!--[endif]-->如果推送失败，则因为远程分支比你的本地更新，需要先用<code><span lang="EN-US">git pull</span></code>试图合并；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span lang="EN-US"><span style="">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp; </span></span></span><!--[endif]-->如果合并有冲突，则解决冲突，并在本地提交；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span lang="EN-US"><span style="">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp; </span></span></span><!--[endif]-->没有冲突或者解决掉冲突后，再用<code><span lang="EN-US">git push origin branch-name</span></code>推送就能成功！<span lang="EN-US"><o:p></o:p></span></p>

<p>如果<code><span lang="EN-US">git pull</span></code>提示<span lang="EN-US">&ldquo;no
tracking information&rdquo;</span>，则说明本地分支和远程分支的链接关系没有创建，用命令<code><span lang="EN-US">git
branch --set-upstream branch-name origin/branch-name</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>这就是多人协作的工作模式，一旦熟悉了，就非常简单。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->查看远程库信息，使用<code><span lang="EN-US">git remote -v</span></code>；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->本地新建的分支如果不推送到远程，对其他人就是不可见的；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->从本地推送分支，使用<code><span lang="EN-US">git push origin
branch-name</span></code>，如果推送失败，先用<code><span lang="EN-US">git pull</span></code>抓取远程的新提交；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->在本地创建和远程分支对应的分支，使用<code><span lang="EN-US">git
checkout -b branch-name origin/branch-name</span></code>，本地和远程分支的名称最好一致；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->建立本地分支和远程分支的关联，使用<code><span lang="EN-US">git
branch --set-upstream branch-name origin/branch-name</span></code>；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->从远程抓取分支，使用<code><span lang="EN-US">git pull</span></code>，如果有冲突，要先处理冲突。<span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">标签管理</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>发布一个版本时，我们通常先在版本库中打一个标签（<span lang="EN-US">tag</span>），这样，就唯一确定了打标签时刻的版本。将来无论什么时候，取某个标签的版本，就是把那个打标签的时刻的历史版本取出来。所以，标签也是版本库的一个快照。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>的标签虽然是版本库的快照，但其实它就是指向某个<span lang="EN-US">commit</span>的指针（跟分支很像对不对？但是分支可以移动，标签不能移动），所以，创建和删除标签都是瞬间完成的。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>有<span lang="EN-US">commit</span>，为什么还要引入<span lang="EN-US">tag</span>？<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">&ldquo;</span>请把上周一的那个版本打包发布，<span lang="EN-US">commit</span>号是<span lang="EN-US">6a5819e...&rdquo;<o:p></o:p></span></p>

<p><span lang="EN-US">&ldquo;</span>一串乱七八糟的数字不好找！<span lang="EN-US">&rdquo;<o:p></o:p></span></p>

<p>如果换一个办法：<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">&ldquo;</span>请把上周一的那个版本打包发布，版本号是<span lang="EN-US">v1.2&rdquo;<o:p></o:p></span></p>

<p><span lang="EN-US">&ldquo;</span>好的，按照<span lang="EN-US">tag v1.2</span>查找<span lang="EN-US">commit</span>就行！<span lang="EN-US">&rdquo;<o:p></o:p></span></p>

<p>所以，<span lang="EN-US">tag</span>就是一个让人容易记住的有意义的名字，它跟某个<span lang="EN-US">commit</span>绑在一起。<span lang="EN-US"><o:p></o:p></span></p>

<h3>创建标签<span lang="EN-US"><o:p></o:p></span></h3>

<p>在<span lang="EN-US">Git</span>中打标签非常简单，首先，切换到需要打标签的分支上：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git branch<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">* dev<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp; </span>master<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git checkout master<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Switched</span></span><code><span lang="EN-US"> to branch </span></code><span class="string"><span lang="EN-US">'master'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>然后，敲命令<code><span lang="EN-US">git tag &lt;name&gt;</span></code>就可以打一个新标签：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>可以用命令<code><span lang="EN-US">git tag</span></code>查看所有标签：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>默认标签是打在最新提交的<span lang="EN-US">commit</span>上的。有时候，如果忘了打标签，比如，现在已经是周五了，但应该在周一打的标签没有打，怎么办？<span lang="EN-US"><o:p></o:p></span></p>

<p>方法是找到历史提交的<span lang="EN-US">commit id</span>，然后打上就可以了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git log --pretty=oneline --abbrev-commit<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">6</span></span><code><span lang="EN-US">a5819e merged bug fix </span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">cc17032 fix bug </span></code><span class="number"><span lang="EN-US">101</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">7825</span></span><code><span lang="EN-US">a5</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> merge with no-ff<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"> add merge<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">59</span></span><code><span lang="EN-US">bc1cb conflict fixed<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">400</span></span><code><span lang="EN-US">b40</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> &amp; simple<o:p></o:p></span></code></pre><pre><span class="number"><span lang="EN-US">75</span></span><code><span lang="EN-US">a857c </span></code><span class="constant"><span lang="EN-US">AND</span></span><code><span lang="EN-US"> simple<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">fec145a branch test<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">d17efd8 remove test.txt<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">...<o:p></o:p></span></code></pre>

<p>比方说要对<code><span lang="EN-US">add merge</span></code>这次提交打标签，它对应的<span lang="EN-US">commit id</span>是<code><span lang="EN-US">6224937</span></code>，敲入命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">9</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>再用命令<code><span lang="EN-US">git tag</span></code>查看标签：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">9</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>注意，标签不是按时间顺序列出，而是按字母排序的。可以用<code><span lang="EN-US">git show &lt;tagname&gt;</span></code>查看标签信息：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">show</span></span><span class="operator"><span lang="EN-US"> v0</span></span><span class="number"><span lang="EN-US">.9</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">622493706</span></span><span class="operator"><span lang="EN-US">ab447b6bb37e4e2a2f276a20fed2ab4<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">Date</span></span><span class="operator"><span lang="EN-US">:<span style="">&nbsp;&nbsp; </span>Thu Aug </span></span><span class="number"><span lang="EN-US">22</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">11</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">22</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">08</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">2013</span></span><span class="operator"><span lang="EN-US"> +</span></span><span class="number"><span lang="EN-US">0800</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span></span></span><span class="keyword"><span lang="EN-US">add</span></span><span class="operator"><span lang="EN-US"> merge<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">...<o:p></o:p></span></span></pre>

<p>可以看到，<code><span lang="EN-US">v0.9</span></code>确实打在<code><span lang="EN-US">add
merge</span></code>这次提交上。<span lang="EN-US"><o:p></o:p></span></p>

<p>还可以创建带有说明的标签，用<code><span lang="EN-US">-a</span></code>指定标签名，<code><span lang="EN-US">-m</span></code>指定说明文字：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag -a v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> -m </span></code><span class="string"><span lang="EN-US">"version 0.1 released"</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">3628164</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>用命令<code><span lang="EN-US">git show &lt;tagname&gt;</span></code>可以看到说明文字：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git show v0.1<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">tag v0.1<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Tagger: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Mon Aug 26 07:28:11 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US">version 0.1 released<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US">commit 3628164fb26d48395383f8f31179f24e0882e1e0<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Tue Aug 20 15:11:49 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>append GPL<o:p></o:p></span></code></pre>

<p>还可以通过<code><span lang="EN-US">-s</span></code>用私钥签名一个标签：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag -s v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">2</span></span><code><span lang="EN-US"> -m </span></code><span class="string"><span lang="EN-US">"signed version 0.2 released"</span></span><code><span lang="EN-US"> fec145a<o:p></o:p></span></code></pre>

<p>签名采用<span lang="EN-US">PGP</span>签名，因此，必须首先安装<span lang="EN-US">gpg</span>（<span lang="EN-US">GnuPG</span>），如果没有找到<span lang="EN-US">gpg</span>，或者没有<span lang="EN-US">gpg</span>密钥对，就会报错：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="symbol"><span lang="EN-US">gpg:</span></span><code><span lang="EN-US"> signing </span></code><span class="symbol"><span lang="EN-US">failed:</span></span><code><span lang="EN-US"> secret key </span></code><span class="keyword"><span lang="EN-US">not</span></span><code><span lang="EN-US"> available<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">error:</span></span><code><span lang="EN-US"> gpg failed to sign the data<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">error:</span></span><code><span lang="EN-US"> unable to sign the tag<o:p></o:p></span></code></pre>

<p>如果报错，请参考<span lang="EN-US">GnuPG</span>帮助文档配置<span lang="EN-US">Key</span>。<span lang="EN-US"><o:p></o:p></span></p>

<p>用命令<code><span lang="EN-US">git show &lt;tagname&gt;</span></code>可以看到<span lang="EN-US">PGP</span>签名信息：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git </span></code><span class="keyword"><span lang="EN-US">show</span></span><span class="operator"><span lang="EN-US"> v0</span></span><span class="number"><span lang="EN-US">.2</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">tag v0</span></span><span class="number"><span lang="EN-US">.2</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Tagger: Michael Liao &lt;askxuefeng@gmail.com&gt;<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">Date</span></span><span class="operator"><span lang="EN-US">:<span style="">&nbsp;&nbsp; </span>Mon Aug </span></span><span class="number"><span lang="EN-US">26</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">07</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">28</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">33</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">2013</span></span><span class="operator"><span lang="EN-US"> +</span></span><span class="number"><span lang="EN-US">0800</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">signed version </span></span><span class="number"><span lang="EN-US">0.2</span></span><span class="operator"><span lang="EN-US"> released<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">-----</span></span><span class="keyword"><span lang="EN-US">BEGIN</span></span><span class="operator"><span lang="EN-US"> PGP SIGNATURE-----<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Version: GnuPG v1</span></span><span class="number"><span lang="EN-US">.4.12</span></span><span class="operator"><span lang="EN-US"> (Darwin)<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">iQEcBAABAgAGBQJSGpMhAAoJEPUxHyDAhBpT4QQIAKeHfR3bo...<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">-----</span></span><span class="keyword"><span lang="EN-US">END</span></span><span class="operator"><span lang="EN-US"> PGP SIGNATURE-----<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">commit</span></span><span class="operator"><span lang="EN-US"> fec145accd63cdc9ed95a2f557ea0658a2a6537f<o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;<o:p></o:p></span></span></pre><pre><span class="keyword"><span lang="EN-US">Date</span></span><span class="operator"><span lang="EN-US">:<span style="">&nbsp;&nbsp; </span>Thu Aug </span></span><span class="number"><span lang="EN-US">22</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">10</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">37</span></span><span class="operator"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">30</span></span><span class="operator"><span lang="EN-US"> </span></span><span class="number"><span lang="EN-US">2013</span></span><span class="operator"><span lang="EN-US"> +</span></span><span class="number"><span lang="EN-US">0800</span></span><span class="operator"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><o:p>&nbsp;</o:p></span></span></pre><pre><span class="operator"><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>branch test<o:p></o:p></span></span></pre>

<p>用<span lang="EN-US">PGP</span>签名的标签是不可伪造的，因为可以验证<span lang="EN-US">PGP</span>签名。验证签名的方法比较复杂，这里就不介绍了。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git tag &lt;name&gt;</span></code>用于新建一个标签，默认为<code><span lang="EN-US">HEAD</span></code>，也可以指定一个<span lang="EN-US">commit id</span>；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><code><span lang="EN-US">git tag -a
&lt;tagname&gt; -m "blablabla..."</span></code>可以指定标签信息；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><code><span lang="EN-US">git tag -s
&lt;tagname&gt; -m "blablabla..."</span></code>可以用<span lang="EN-US">PGP</span>签名标签；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git tag</span></code>可以查看所有标签。<span lang="EN-US"><o:p></o:p></span></p>

<h3>操作标签<span lang="EN-US"><o:p></o:p></span></h3>

<p>如果标签打错了，也可以删除：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag -d v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> tag </span></code><span class="string"><span lang="EN-US">'v0.1'</span></span><code><span lang="EN-US"> (was e078af9)<o:p></o:p></span></code></pre>

<p>因为创建的标签都只存储在本地，不会自动推送到远程。所以，打错的标签可以在本地安全删除。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果要推送某个标签到远程，使用命令<code><span lang="EN-US">git push origin &lt;tagname&gt;</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git push origin v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Total</span></span><code><span lang="EN-US"> </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">), reused </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">To</span></span><code><span lang="EN-US"> git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> * [new tag]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> -&gt; v1.</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>或者，一次性推送全部尚未推送到远程的本地标签：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git push origin --tags<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Counting objects: </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US">, done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Writing objects: </span></code><span class="number"><span lang="EN-US">100</span></span><code><span lang="EN-US">% (</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US">/</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US">), </span></code><span class="number"><span lang="EN-US">554</span></span><code><span lang="EN-US"> bytes, done.<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Total </span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">), reused </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"> (delta </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">To git</span></code><span class="annotation"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.com:michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> * [</span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> tag]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>v0</span></code><span class="number"><span lang="EN-US">.2</span></span><code><span lang="EN-US"> -&gt; v0</span></code><span class="number"><span lang="EN-US">.2</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> * [</span></code><span class="keyword"><span lang="EN-US">new</span></span><code><span lang="EN-US"> tag]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>v0</span></code><span class="number"><span lang="EN-US">.9</span></span><code><span lang="EN-US"> -&gt; v0</span></code><span class="number"><span lang="EN-US">.9</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>如果标签已经推送到远程，要删除远程标签就麻烦一点，先从本地删除：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git tag -d v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">9</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Deleted</span></span><code><span lang="EN-US"> tag </span></code><span class="string"><span lang="EN-US">'v0.9'</span></span><code><span lang="EN-US"> (was </span></code><span class="number"><span lang="EN-US">6224937</span></span><code><span lang="EN-US">)<o:p></o:p></span></code></pre>

<p>然后，从远程删除。删除命令也是<span lang="EN-US">push</span>，但是格式如下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git push origin </span></code><span class="symbol"><span lang="EN-US">:refs/tags/v0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">9</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">To</span></span><code><span lang="EN-US"> git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"> - [deleted]<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>v</span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US">.</span></code><span class="number"><span lang="EN-US">9</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>要看看是否真的从远程库删除了标签，可以登陆<span lang="EN-US">GitHub</span>查看。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git push origin
&lt;tagname&gt;</span></code>可以推送一个本地标签；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git push origin --tags</span></code>可以推送全部未推送过的本地标签；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git tag -d
&lt;tagname&gt;</span></code>可以删除一个本地标签；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->命令<code><span lang="EN-US">git push origin
:refs/tags/&lt;tagname&gt;</span></code>可以删除一个远程标签。<span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">使用</span><span lang="EN-US">GitHub<o:p></o:p></span></h2>

<p>我们一直用<span lang="EN-US">GitHub</span>作为免费的远程仓库，如果是个人的开源项目，放到<span lang="EN-US">GitHub</span>上是完全没有问题的。其实<span lang="EN-US">GitHub</span>还是一个开源协作社区，通过<span lang="EN-US">GitHub</span>，既可以让别人参与你的开源项目，也可以参与别人的开源项目。<span lang="EN-US"><o:p></o:p></span></p>

<p>在<span lang="EN-US">GitHub</span>出现以前，开源项目开源容易，但让广大人民群众参与进来比较困难，因为要参与，就要提交代码，而给每个想提交代码的群众都开一个账号那是不现实的，因此，群众也仅限于报个<span lang="EN-US">bug</span>，即使能改掉<span lang="EN-US">bug</span>，也只能把<span lang="EN-US">diff</span>文件用邮件发过去，很不方便。<span lang="EN-US"><o:p></o:p></span></p>

<p>但是在<span lang="EN-US">GitHub</span>上，利用<span lang="EN-US">Git</span>极其强大的克隆和分支功能，广大人民群众真正可以第一次自由参与各种开源项目了。<span lang="EN-US"><o:p></o:p></span></p>

<p>如何参与一个开源项目呢？比如人气极高的<span lang="EN-US">bootstrap</span>项目，这是一个非常强大的<span lang="EN-US">CSS</span>框架，你可以访问它的项目主页<span lang="EN-US"><a href="https://github.com/twbs/bootstrap" target="_blank">https://github.com/twbs/bootstrap</a></span>，点<span lang="EN-US">&ldquo;Fork&rdquo;</span>就在自己的账号下克隆了一个<span lang="EN-US">bootstrap</span>仓库，然后，从自己的账号下<span lang="EN-US">clone</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">git clone git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/bootstrap.git<o:p></o:p></span></code></pre>

<p>一定要从自己的账号下<span lang="EN-US">clone</span>仓库，这样你才能推送修改。如果从<span lang="EN-US">bootstrap</span>的作者的仓库地址<code><span lang="EN-US">git@github.com:twbs/bootstrap.git</span></code>克隆，因为没有权限，你将不能推送修改。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Bootstrap</span>的官方仓库<code><span lang="EN-US">twbs/bootstrap</span></code>、你在<span lang="EN-US">GitHub</span>上克隆的仓库<code><span lang="EN-US">my/bootstrap</span></code>，以及你自己克隆到本地电脑的仓库，他们的关系就像下图显示的那样：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_32"
 o:spid="_x0000_i1027" type="#_x0000_t75" alt="github-repos" style='width:284.25pt;
 height:127.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image032.png"
  o:title="github-repos"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image032.png" alt="github-repos" v:shapes="图片_x0020_32" border="0" height="170" width="379"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>如果你想修复<span lang="EN-US">bootstrap</span>的一个<span lang="EN-US">bug</span>，或者新增一个功能，立刻就可以开始干活，干完后，往自己的仓库推送。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你希望<span lang="EN-US">bootstrap</span>的官方库能接受你的修改，你就可以在<span lang="EN-US">GitHub</span>上发起一个<span lang="EN-US">pull request</span>。当然，对方是否接受你的<span lang="EN-US">pull request</span>就不一定了。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你没能力修改<span lang="EN-US">bootstrap</span>，但又想要试一把<span lang="EN-US">pull
request</span>，那就<span lang="EN-US">Fork</span>一下我的仓库：<span lang="EN-US"><a href="https://github.com/michaelliao/learngit" target="_blank">https://github.com/michaelliao/learngit</a></span>，创建一个<code><span lang="EN-US">your-github-id.txt</span></code>的文本文件，写点自己学习<span lang="EN-US">Git</span>的心得，然后推送一个<span lang="EN-US">pull request</span>给我，我会视心情而定是否接受。<span lang="EN-US"><o:p></o:p></span></p>

<h3>小结<span lang="EN-US"><o:p></o:p></span></h3>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->在<span lang="EN-US">GitHub</span>上，可以任意<span lang="EN-US">Fork</span>开源仓库；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->自己拥有<span lang="EN-US">Fork</span>后的仓库的读写权限；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->可以推送<span lang="EN-US">pull request</span>给官方仓库来贡献代码。<span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">自定义</span><span lang="EN-US">Git<o:p></o:p></span></h2>

<p>在<span lang="EN-US"><a href="#_%E5%AE%89%E8%A3%85Git" target="_blank"><span lang="EN-US"><span lang="EN-US">安装Git</span></span></a></span>一节中，我们已经配置了<code><span lang="EN-US">user.name</span></code>和<code><span lang="EN-US">user.email</span></code>，实际上，<span lang="EN-US">Git</span>还有很多可配置项。<span lang="EN-US"><o:p></o:p></span></p>

<p>比如，让<span lang="EN-US">Git</span>显示颜色，会让命令输出看起来更醒目：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global color.ui </span></code><span class="keyword"><span lang="EN-US">true</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>这样，<span lang="EN-US">Git</span>会适当地显示不同的颜色，比如<code><span lang="EN-US">git
status</span></code>命令：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_33"
 o:spid="_x0000_i1026" type="#_x0000_t75" alt="git-color" style='width:328.5pt;
 height:221.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image033.png"
  o:title="git-color"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image033.png" alt="git-color" v:shapes="图片_x0020_33" border="0" height="295" width="438"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>文件名就会标上颜色。<span lang="EN-US"><o:p></o:p></span></p>

<p>我们在后面还会介绍如何更好地配置<span lang="EN-US">Git</span>，以便让你的工作更高效。<span lang="EN-US"><o:p></o:p></span></p>

<h3>忽略特殊文件<span lang="EN-US"><o:p></o:p></span></h3>

<p>有些时候，你必须把某些文件放到<span lang="EN-US">Git</span>工作目录中，但又不能提交它们，比如保存了数据库密码的配置文件啦，等等，每次<code><span lang="EN-US">git status</span></code>都会显示<code><span lang="EN-US">Untracked files
...</span></code>，有强迫症的童鞋心里肯定不爽。<span lang="EN-US"><o:p></o:p></span></p>

<p>好在<span lang="EN-US">Git</span>考虑到了大家的感受，这个问题解决起来也很简单，在<span lang="EN-US">Git</span>工作区的根目录下创建一个特殊的<code><span lang="EN-US">.gitignore</span></code>文件，然后把要忽略的文件名填进去，<span lang="EN-US">Git</span>就会自动忽略这些文件。<span lang="EN-US"><o:p></o:p></span></p>

<p>不需要从头写<code><span lang="EN-US">.gitignore</span></code>文件，<span lang="EN-US">GitHub</span>已经为我们准备了各种配置文件，只需要组合一下就可以使用了。所有配置文件可以直接在线浏览：<span lang="EN-US"><a href="https://github.com/github/gitignore" target="_blank">https://github.com/github/gitignore</a><o:p></o:p></span></p>

<p>忽略文件的原则是：<span lang="EN-US"><o:p></o:p></span></p>

<ol start="1" type="1"><li class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体;">忽略操作系统自动生成的文件，比如缩略图等；</span><span lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体;">忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如</span><span lang="EN-US">Java</span><span style="font-family: 宋体;">编译产生的</span><code><span style="font-size: 12pt;" lang="EN-US">.class</span></code><span style="font-family: 宋体;">文件；</span><span lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体;">忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。</span><span lang="EN-US"><o:p></o:p></span></li></ol>

<p>举个例子：<span lang="EN-US"><o:p></o:p></span></p>

<p>假设你在<span lang="EN-US">Windows</span>下进行<span lang="EN-US">Python</span>开发，<span lang="EN-US">Windows</span>会自动在有图片的目录下生成隐藏的缩略图文件，如果有自定义目录，目录下就会有<code><span lang="EN-US">Desktop.ini</span></code>文件，因此你需要忽略<span lang="EN-US">Windows</span>自动生成的垃圾文件：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="comment"><span lang="EN-US"># Windows:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Thumbs</span></span><code><span lang="EN-US">.db<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">ehthumbs.db<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Desktop</span></span><code><span lang="EN-US">.ini<o:p></o:p></span></code></pre>

<p>然后，继续忽略<span lang="EN-US">Python</span>编译产生的<code><span lang="EN-US">.pyc</span></code>、<code><span lang="EN-US">.pyo</span></code>、<code><span lang="EN-US">dist</span></code>等文件或目录：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="comment"><span lang="EN-US"># Python:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.py[cod]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.so<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.egg<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.egg-info<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">dist<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">build<o:p></o:p></span></code></pre>

<p>加上你自己定义的文件，最终得到一个完整的<code><span lang="EN-US">.gitignore</span></code>文件，内容如下：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="comment"><span lang="EN-US"># Windows:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Thumbs</span></span><code><span lang="EN-US">.db<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">ehthumbs.db<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Desktop</span></span><code><span lang="EN-US">.ini<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># Python:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.py[cod]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.so<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.egg<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">*.egg-info<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">dist<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">build<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><span class="comment"><span lang="EN-US"># My configurations:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">db.ini<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">deploy_key_rsa<o:p></o:p></span></code></pre>

<p>最后一步就是把<code><span lang="EN-US">.gitignore</span></code>也提交到<span lang="EN-US">Git</span>，就完成了！当然检验<code><span lang="EN-US">.gitignore</span></code>的标准是<code><span lang="EN-US">git status</span></code>命令是不是说<code><span lang="EN-US">working directory clean</span></code>。<span lang="EN-US"><o:p></o:p></span></p>

<p>使用<span lang="EN-US">Windows</span>的童鞋注意了，如果你在资源管理器里新建一个<code><span lang="EN-US">.gitignore</span></code>文件，它会非常弱智地提示你必须输入文件名，但是在文本编辑器里<span lang="EN-US">&ldquo;</span>保存<span lang="EN-US">&rdquo;</span>或者<span lang="EN-US">&ldquo;</span>另存为<span lang="EN-US">&rdquo;</span>就可以把文件保存为<code><span lang="EN-US">.gitignore</span></code>了。<span lang="EN-US"><o:p></o:p></span></p>

<p>有些时候，你想添加一个文件到<span lang="EN-US">Git</span>，但发现添加不了，原因是这个文件被<code><span lang="EN-US">.gitignore</span></code>忽略了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git add </span></code><span class="constant"><span lang="EN-US">App</span></span><code><span lang="EN-US">.</span></code><span class="keyword"><span lang="EN-US">class</span></span><span class="class"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="1"><span lang="EN-US">The</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">following</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">paths</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">are</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">ignored</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">by</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">one</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">of</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">your</span></span><span class="class"><span lang="EN-US"> .</span></span><span class="1"><span lang="EN-US">gitignore</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">files</span></span><span class="class"><span lang="EN-US">:</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">App</span></span><code><span lang="EN-US">.</span></code><span class="keyword"><span lang="EN-US">class</span></span><span class="class"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="1"><span lang="EN-US">Use</span></span><span class="class"><span lang="EN-US"> -</span></span><span class="1"><span lang="EN-US">f</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">if</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">you</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">really</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">want</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">to</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">add</span></span><span class="class"><span lang="EN-US"> </span></span><span class="1"><span lang="EN-US">them</span></span><span class="class"><span lang="EN-US">.</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>如果你确实想添加该文件，可以用<code><span lang="EN-US">-f</span></code>强制添加到<span lang="EN-US">Git</span>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git add -f App.</span></code><span class="keyword"><span lang="EN-US">class</span></span><span class="class"><span lang="EN-US"><o:p></o:p></span></span></pre>

<p>或者你发现，可能是<code><span lang="EN-US">.gitignore</span></code>写得有问题，需要找出来到底哪个规则写错了，可以用<code><span lang="EN-US">git check-ignore</span></code>命令检查：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git check-ignore -v </span></code><span class="constant"><span lang="EN-US">App</span></span><code><span lang="EN-US">.</span></code><span class="keyword"><span lang="EN-US">class</span></span><span class="class"><span lang="EN-US"><o:p></o:p></span></span></pre><pre><span class="class"><span lang="EN-US">.</span></span><span class="1"><span lang="EN-US">gitignore</span></span><span class="class"><span lang="EN-US">:3:*.</span></span><span class="1"><span lang="EN-US">class</span></span><span class="class"><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span></span></span><span class="1"><span lang="EN-US">App</span></span><span class="class"><span lang="EN-US">.</span></span><span class="1"><span lang="EN-US">class</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><span lang="EN-US">Git</span>会告诉我们，<code><span lang="EN-US">.gitignore</span></code>的第<span lang="EN-US">3</span>行规则忽略了该文件，于是我们就可以知道应该修订哪个规则。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->忽略某些文件时，需要编写<code><span lang="EN-US">.gitignore</span></code>；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><code><span lang="EN-US">.gitignore</span></code>文件本身要放到版本库里，并且可以对<code><span lang="EN-US">.gitignore</span></code>做版本管理！<span lang="EN-US"><o:p></o:p></span></p>

<h3>配置别名<span lang="EN-US"><o:p></o:p></span></h3>

<p>有没有经常敲错命令？比如<code><span lang="EN-US">git status</span></code>？<code><span lang="EN-US">status</span></code>这个单词真心不好记。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果敲<code><span lang="EN-US">git st</span></code>就表示<code><span lang="EN-US">git
status</span></code>那就简单多了，当然这种偷懒的办法我们是极力赞成的。<span lang="EN-US"><o:p></o:p></span></p>

<p>我们只需要敲一行命令，告诉<span lang="EN-US">Git</span>，以后<code><span lang="EN-US">st</span></code>就表示<code><span lang="EN-US">status</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.st status<o:p></o:p></span></code></pre>

<p>好了，现在敲<code><span lang="EN-US">git st</span></code>看看效果。<span lang="EN-US"><o:p></o:p></span></p>

<p>当然还有别的命令可以简写，很多人都用<code><span lang="EN-US">co</span></code>表示<code><span lang="EN-US">checkout</span></code>，<code><span lang="EN-US">ci</span></code>表示<code><span lang="EN-US">commit</span></code>，<code><span lang="EN-US">br</span></code>表示<code><span lang="EN-US">branch</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.co checkout<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.ci commit<o:p></o:p></span></code></pre><pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.br branch<o:p></o:p></span></code></pre>

<p>以后提交就可以简写成：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git ci -m </span></code><span class="string"><span lang="EN-US">"bala bala bala..."</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p><code><span lang="EN-US">--global</span></code>参数是全局参数，也就是这些命令在这台电脑的所有<span lang="EN-US">Git</span>仓库下都有用。<span lang="EN-US"><o:p></o:p></span></p>

<p>在<span lang="EN-US"><a href="#_%E6%92%A4%E9%94%80%E4%BF%AE%E6%94%B9" target="_blank"><span lang="EN-US"><span lang="EN-US">撤销修改</span></span></a></span>一节中，我们知道，命令<code><span lang="EN-US">git
reset HEAD file</span></code>可以把暂存区的修改撤销掉（<span lang="EN-US">unstage</span>），重新放回工作区。既然是一个<span lang="EN-US">unstage</span>操作，就可以配置一个<code><span lang="EN-US">unstage</span></code>别名：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.unstage </span></code><span class="string"><span lang="EN-US">'reset HEAD'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>当你敲入命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git unstage test.py<o:p></o:p></span></code></pre>

<p>实际上<span lang="EN-US">Git</span>执行的是：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git re</span></code><span class="keyword"><span lang="EN-US">set</span></span><span class="operator"><span lang="EN-US"> HEAD test.py<o:p></o:p></span></span></pre>

<p>配置一个<code><span lang="EN-US">git last</span></code>，让其显示最后一次提交信息：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.last </span></code><span class="string"><span lang="EN-US">'log -1'</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>这样，用<code><span lang="EN-US">git last</span></code>就能显示最近一次的提交：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ git last<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">commit adca45d317e6d8a4b23f9811c3d7b7f0f180bfe2<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Merge: bd6ae48 291bea8<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Author: Michael Liao </span></code><span class="tag"><span lang="EN-US">&lt;</span></span><span class="1"><span lang="EN-US">askxuefeng@gmail.com</span></span><span class="tag"><span lang="EN-US">&gt;</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">Date:<span style="">&nbsp;&nbsp; </span>Thu Aug 22 22:49:22 2013 +0800<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><o:p>&nbsp;</o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>merge &amp; fix hello.py<o:p></o:p></span></code></pre>

<p>甚至还有人丧心病狂地把<code><span lang="EN-US">lg</span></code>配置成了：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">git config --global </span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">.lg </span></code><span class="string"><span lang="EN-US">"log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit"</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>来看看<code><span lang="EN-US">git lg</span></code>的效果：<span lang="EN-US"><o:p></o:p></span></p>

<p><span style="" lang="EN-US"><!--[if gte vml 1]><v:shape id="图片_x0020_34"
 o:spid="_x0000_i1025" type="#_x0000_t75" alt="git-lg" style='width:331.5pt;
 height:223.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="./GitIntroduction_img/image034.png"
  o:title="git-lg"/>
</v:shape><![endif]--><!--[if !vml]--><img src="./GitIntroduction_img/image034.png" alt="git-lg" v:shapes="图片_x0020_34" border="0" height="298" width="442"><!--[endif]--></span><span lang="EN-US"><o:p></o:p></span></p>

<p>为什么不早点告诉我？别激动，咱不是为了多记几个英文单词嘛！<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E9-85-8D-E7-BD-AE-E6-96-87-E4-BB-B6"></a><span style="font-family: 宋体;">配置文件</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>配置<span lang="EN-US">Git</span>的时候，加上<code><span lang="EN-US">--global</span></code>是针对当前用户起作用的，如果不加，那只针对当前的仓库起作用。<span lang="EN-US"><o:p></o:p></span></p>

<p>配置文件放哪了？每个仓库的<span lang="EN-US">Git</span>配置文件都放在<code><span lang="EN-US">.git/config</span></code>文件中：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">cat .git/config <o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[core]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>repositoryformatversion = </span></code><span class="number"><span lang="EN-US">0</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>filemode = </span></code><span class="keyword"><span lang="EN-US">true</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>bare = </span></code><span class="keyword"><span lang="EN-US">false</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>logallrefupdates = </span></code><span class="keyword"><span lang="EN-US">true</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>ignorecase = </span></code><span class="keyword"><span lang="EN-US">true</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>precomposeunicode = </span></code><span class="keyword"><span lang="EN-US">true</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[remote </span></code><span class="string"><span lang="EN-US">"origin"</span></span><code><span lang="EN-US">]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>url = git</span></code><span class="variable"><span lang="EN-US">@github</span></span><code><span lang="EN-US">.</span></code><span class="symbol"><span lang="EN-US">com:</span></span><code><span lang="EN-US">michaelliao/learngit.git<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>fetch = +refs/heads/*</span></code><span class="symbol"><span lang="EN-US">:refs/remotes/origin/*</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[branch </span></code><span class="string"><span lang="EN-US">"master"</span></span><code><span lang="EN-US">]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>remote = origin<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>merge = refs/heads/master<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[</span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>last = log -</span></code><span class="number"><span lang="EN-US">1</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>别名就在<code><span lang="EN-US">[alias]</span></code>后面，要删除别名，直接把对应的行删掉即可。<span lang="EN-US"><o:p></o:p></span></p>

<p>而当前用户的<span lang="EN-US">Git</span>配置文件放在用户主目录下的一个隐藏文件<code><span lang="EN-US">.gitconfig</span></code>中：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">cat .gitconfig<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[</span></code><span class="keyword"><span lang="EN-US">alias</span></span><code><span lang="EN-US">]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>co = checkout<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>ci = commit<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>br = branch<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>st = status<o:p></o:p></span></code></pre><pre><code><span lang="EN-US">[user]<o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>name = </span></code><span class="constant"><span lang="EN-US">Your</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">Name</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre><pre><code><span lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp; </span>email = your</span></code><span class="variable"><span lang="EN-US">@email</span></span><code><span lang="EN-US">.com<o:p></o:p></span></code></pre>

<p>配置别名也可以直接修改这个文件，如果改错了，可以删掉文件重新通过命令配置。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>给<span lang="EN-US">Git</span>配置好别名，就可以输入命令时偷个懒。我们鼓励偷懒。<span lang="EN-US"><o:p></o:p></span></p>

<h3>搭建<span lang="EN-US">Git</span>服务器<span lang="EN-US"><o:p></o:p></span></h3>

<p>在<span lang="EN-US"><a href="#_%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93" target="_blank"><span lang="EN-US"><span lang="EN-US">远程仓库</span></span></a></span>一节中，我们讲了远程仓库实际上和本地仓库没啥不同，纯粹为了<span lang="EN-US">7x24</span>小时开机并交换大家的修改。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">GitHub</span>就是一个免费托管开源代码的远程仓库。但是对于某些视源代码如生命的商业公司来说，既不想公开源代码，又舍不得给<span lang="EN-US">GitHub</span>交保护费，那就只能自己搭建一台<span lang="EN-US">Git</span>服务器作为私有仓库使用。<span lang="EN-US"><o:p></o:p></span></p>

<p>搭建<span lang="EN-US">Git</span>服务器需要准备一台运行<span lang="EN-US">Linux</span>的机器，强烈推荐用<span lang="EN-US">Ubuntu</span>或<span lang="EN-US">Debian</span>，这样，通过几条简单的<code><span lang="EN-US">apt</span></code>命令就可以完成安装。<span lang="EN-US"><o:p></o:p></span></p>

<p>假设你已经有<code><span lang="EN-US">sudo</span></code>权限的用户账号，下面，正式开始安装。<span lang="EN-US"><o:p></o:p></span></p>

<p>第一步，安装<code><span lang="EN-US">git</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ su</span></code><span class="keyword"><span lang="EN-US">do</span></span><span class="operator"><span lang="EN-US"> apt-</span></span><span class="keyword"><span lang="EN-US">get</span></span><span class="operator"><span lang="EN-US"> install git<o:p></o:p></span></span></pre>

<p>第二步，创建一个<code><span lang="EN-US">git</span></code>用户，用来运行<code><span lang="EN-US">git</span></code>服务：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ su</span></code><span class="keyword"><span lang="EN-US">do</span></span><span class="operator"><span lang="EN-US"> adduser git<o:p></o:p></span></span></pre>

<p>第三步，创建证书登录：<span lang="EN-US"><o:p></o:p></span></p>

<p>收集所有需要登录的用户的公钥，就是他们自己的<code><span lang="EN-US">id_rsa.pub</span></code>文件，把所有公钥导入到<code><span lang="EN-US">/home/git/.ssh/authorized_keys</span></code>文件里，一行一个。<span lang="EN-US"><o:p></o:p></span></p>

<p>第四步，初始化<span lang="EN-US">Git</span>仓库：<span lang="EN-US"><o:p></o:p></span></p>

<p>先选定一个目录作为<span lang="EN-US">Git</span>仓库，假定是<code><span lang="EN-US">/srv/sample.git</span></code>，在<code><span lang="EN-US">/srv</span></code>目录下输入命令：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ su</span></code><span class="keyword"><span lang="EN-US">do</span></span><span class="operator"><span lang="EN-US"> git init --bare sample.git<o:p></o:p></span></span></pre>

<p><span lang="EN-US">Git</span>就会创建一个裸仓库，裸仓库没有工作区，因为服务器上的<span lang="EN-US">Git</span>仓库纯粹是为了共享，所以不让用户直接登录到服务器上去改工作区，并且服务器上的<span lang="EN-US">Git</span>仓库通常都以<code><span lang="EN-US">.git</span></code>结尾。然后，把<span lang="EN-US">owner</span>改为<code><span lang="EN-US">git</span></code>：<span lang="EN-US"><o:p></o:p></span></p>

<pre><code><span lang="EN-US">$ su</span></code><span class="keyword"><span lang="EN-US">do</span></span><span class="operator"><span lang="EN-US"> chown -R git:git sample.git<o:p></o:p></span></span></pre>

<p>第五步，禁用<span lang="EN-US">shell</span>登录：<span lang="EN-US"><o:p></o:p></span></p>

<p>出于安全考虑，第二步创建的<span lang="EN-US">git</span>用户不允许登录<span lang="EN-US">shell</span>，这可以通过编辑<code><span lang="EN-US">/etc/passwd</span></code>文件完成。找到类似下面的一行：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="symbol"><span lang="EN-US">git:x:</span></span><span class="number"><span lang="EN-US">1001</span></span><span class="symbol"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">1001</span></span><span class="symbol"><span lang="EN-US">:</span></span><code><span lang="EN-US">,,,</span></code><span class="symbol"><span lang="EN-US">:/home/git:/bin/bash</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>改为：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="symbol"><span lang="EN-US">git:x:</span></span><span class="number"><span lang="EN-US">1001</span></span><span class="symbol"><span lang="EN-US">:</span></span><span class="number"><span lang="EN-US">1001</span></span><span class="symbol"><span lang="EN-US">:</span></span><code><span lang="EN-US">,,,</span></code><span class="symbol"><span lang="EN-US">:/home/git:/usr/bin/git-shell</span></span><code><span lang="EN-US"><o:p></o:p></span></code></pre>

<p>这样，<code><span lang="EN-US">git</span></code>用户可以正常通过<span lang="EN-US">ssh</span>使用<span lang="EN-US">git</span>，但无法登录<span lang="EN-US">shell</span>，因为我们为<code><span lang="EN-US">git</span></code>用户指定的<code><span lang="EN-US">git-shell</span></code>每次一登录就自动退出。<span lang="EN-US"><o:p></o:p></span></p>

<p>第六步，克隆远程仓库：<span lang="EN-US"><o:p></o:p></span></p>

<p>现在，可以通过<code><span lang="EN-US">git clone</span></code>命令克隆远程仓库了，在各自的电脑上运行：<span lang="EN-US"><o:p></o:p></span></p>

<pre><span class="variable"><span lang="EN-US">$ </span></span><code><span lang="EN-US">git clone git</span></code><span class="variable"><span lang="EN-US">@server</span></span><span class="symbol"><span lang="EN-US">:/srv/sample</span></span><code><span lang="EN-US">.git<o:p></o:p></span></code></pre><pre><span class="constant"><span lang="EN-US">Cloning</span></span><code><span lang="EN-US"> into </span></code><span class="string"><span lang="EN-US">'sample'</span></span><code><span lang="EN-US">...<o:p></o:p></span></code></pre><pre><span class="symbol"><span lang="EN-US">warning:</span></span><code><span lang="EN-US"> </span></code><span class="constant"><span lang="EN-US">You</span></span><code><span lang="EN-US"> appear to have cloned an empty repository.<o:p></o:p></span></code></pre>

<p>剩下的推送就简单了。<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E7-AE-A1-E7-90-86-E5-85-AC-E9-92-A5"></a><span style="font-family: 宋体;">管理公钥</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>如果团队很小，把每个人的公钥收集起来放到服务器的<code><span lang="EN-US">/home/git/.ssh/authorized_keys</span></code>文件里就是可行的。如果团队有几百号人，就没法这么玩了，这时，可以用<span lang="EN-US"><a href="https://github.com/res0nat0r/gitosis" target="_blank">Gitosis</a></span>来管理公钥。<span lang="EN-US"><o:p></o:p></span></p>

<p>这里我们不介绍怎么玩<span lang="EN-US"><a href="https://github.com/res0nat0r/gitosis" target="_blank">Gitosis</a></span>了，几百号人的团队基本都在<span lang="EN-US">500</span>强了，相信找个高水平的<span lang="EN-US">Linux</span>管理员问题不大。<span lang="EN-US"><o:p></o:p></span></p>

<h4><a name="#-E7-AE-A1-E7-90-86-E6-9D-83-E9-99-90"></a><span style="font-family: 宋体;">管理权限</span><span lang="EN-US"><o:p></o:p></span></h4>

<p>有很多不但视源代码如生命，而且视员工为窃贼的公司，会在版本控制系统里设置一套完善的权限控制，每个人是否有读写权限会精确到每个分支甚至每个目录下。因为<span lang="EN-US">Git</span>是为<span lang="EN-US">Linux</span>源代码托管而开发的，所以<span lang="EN-US">Git</span>也继承了开源社区的精神，不支持权限控制。不过，因为<span lang="EN-US">Git</span>支持钩子（<span lang="EN-US">hook</span>），所以，可以在服务器端编写一系列脚本来控制提交等操作，达到权限控制的目的。<span lang="EN-US"><a href="https://github.com/sitaramc/gitolite" target="_blank">Gitolite</a></span>就是这个工具。<span lang="EN-US"><o:p></o:p></span></p>

<p>这里我们也不介绍<span lang="EN-US"><a href="https://github.com/sitaramc/gitolite" target="_blank">Gitolite</a></span>了，不要把有限的生命浪费到权限斗争中。<span lang="EN-US"><o:p></o:p></span></p>

<h4><span style="font-family: 宋体;">小结</span><span lang="EN-US"><o:p></o:p></span></h4>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->搭建<span lang="EN-US">Git</span>服务器非常简单，通常<span lang="EN-US">10</span>分钟即可完成；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->要方便管理公钥，用<span lang="EN-US"><a href="https://github.com/sitaramc/gitolite" target="_blank">Gitosis</a></span>；<span lang="EN-US"><o:p></o:p></span></p>

<p style="margin-left: 36pt; text-indent: -18pt;"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">&middot;<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]-->要像<span lang="EN-US">SVN</span>那样变态地控制权限，用<span lang="EN-US"><a href="https://github.com/sitaramc/gitolite" target="_blank">Gitolite</a></span>。<span lang="EN-US"><o:p></o:p></span></p>

<h2><span style="font-family: 宋体;">总结</span><span lang="EN-US"><o:p></o:p></span></h2>

<p>终于到了期末总结的时刻了！<span lang="EN-US"><o:p></o:p></span></p>

<p>经过几天的学习，相信你对<span lang="EN-US">Git</span>已经初步掌握。一开始，可能觉得<span lang="EN-US">Git</span>上手比较困难，尤其是已经熟悉<span lang="EN-US">SVN</span>的童鞋，没关系，多操练几次，就会越用越顺手。<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US">Git</span>虽然极其强大，命令繁多，但常用的就那么十来个，掌握好这十几个常用命令，你已经可以得心应手地使用<span lang="EN-US">Git</span>了。<span lang="EN-US"><o:p></o:p></span></p>

<p>友情附赠国外网友制作的<span lang="EN-US">Git Cheat Sheet</span>，建议打印出来备用：<span lang="EN-US"><o:p></o:p></span></p>

<p><span lang="EN-US"><a href="https://pan.baidu.com/s/1kU5OCOB#path=%252Fpub%252Fgit" target="_blank">Git
Cheat Sheet</a><o:p></o:p></span></p>

<p>现在告诉你<span lang="EN-US">Git</span>的官方网站：<span lang="EN-US"><a href="http://git-scm.com" target="_blank">http://git-scm.com</a></span>，英文自我感觉不错的童鞋，可以经常去官网看看。什么，打不开网站？相信我，我给出的绝对是官网地址，而且，<span lang="EN-US">Git</span>官网决没有那么容易宕机，可能是你的人品问题，赶紧面壁思过，好好想想原因。<span lang="EN-US"><o:p></o:p></span></p>

<p>如果你学了<span lang="EN-US">Git</span>后，工作效率大增，有更多的空闲时间健身看电影，那我的教学目标就达到了。<span lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>
</body></html>